{"version":3,"file":"js/532.df7613c9.js","mappings":"8PASO,MAAMA,EAAmBC,UAG9B,MAAMC,QAAYC,EAAAA,EAAAA,KAAUC,IAA6B,kBAAmB,CAC1EC,aAAc,CACZC,WAAYC,KAIhB,IAAKL,EACH,MAAM,IAAIM,EAAAA,EAAoBR,EAAiBS,MAGjD,OAAOP,CAAG,EAGCQ,EAAgBT,UAG3B,MAAMC,QAAYC,EAAAA,EAAAA,KAAUC,IAC1B,eACA,CACEC,aAAc,CACZC,WAAYC,KAKlB,IAAKL,EACH,MAAM,IAAIM,EAAAA,EAAoBE,EAAcD,MAG9C,OAAOP,CAAG,EAGCS,EAAiBV,UAG5B,MAAMC,QAAYC,EAAAA,EAAAA,KAAUC,IAC1B,gBACA,CAAEC,aAAc,IAAKO,KAGvB,IAAKV,EACH,MAAM,IAAIM,EAAAA,EAAoBG,EAAeF,MAG/C,OAAOP,CAAG,EAGCW,EAAiBZ,UAG5B,MAAMC,QAAYC,EAAAA,EAAAA,KAAUW,KAA8B,eAAgB,IACrEC,EACHC,MAAOC,KAAKC,UAAUH,EAAQC,OAC9BG,WAAYF,KAAKC,UAAUH,EAAQI,YACnCC,aAAcH,KAAKC,UAAUH,EAAQK,gBAGvC,IAAKlB,EACH,MAAM,IAAIM,EAAAA,EAAoBK,EAAeJ,MAG/C,OAAOP,CAAG,EAGCmB,EAAkBpB,UAG7B,MAAMC,QAAYC,EAAAA,EAAAA,KAAUW,KAA8B,gBAAiB,IACtEC,EACHC,MAAOC,KAAKC,UAAUH,EAAQC,OAC9BG,WAAYF,KAAKC,UAAUH,EAAQI,YACnCC,aAAcH,KAAKC,UAAUH,EAAQK,gBAGvC,IAAKlB,EACH,MAAM,IAAIM,EAAAA,EAAoBa,EAAgBZ,MAGhD,OAAOP,CAAG,C,uDC1FL,MAAMoB,EAAM,E,qDCAZ,MAMMC,EAA2BA,CACtCC,EACAC,EAAS,IAEF,IAAIC,KAAKC,aAAa,QAAS,CACpCC,sBAAuBH,EACvBI,sBAAuBJ,IAEtBK,OACkB,kBAAVN,GACFA,EAAMO,WAAW,MAAO,IAAIC,QAAQ,IAAK,KAC1CR,GAELQ,QAAQ,IAAK,I,qECjBX,MAAMC,EAAkBC,IAAY,CACzCA,IAAKC,EAAAA,GAAQC,YACX,wBAAwBF,GAAO,KAC9BV,GAAkBa,OAAOb,EAAMQ,QAAQ,MAAO,OAASE,GAAO,M,6GCyD5D,MAAMI,EAAYA,KACvB,MAAMC,EAA8C,CAClDC,QAAS,CACPhB,MAAO,KACPjB,GAAI,aACJkC,MAAO,aACPC,MAAO,GACPC,OAAOC,EAAAA,EAAAA,KACPC,YAAa,IAEfC,MAAO,CACLtB,MAAO,KACPjB,GAAI,WACJkC,MAAO,QACPC,MAAO,GACPC,OAAOC,EAAAA,EAAAA,KACPC,YAAa,GACbE,WAAW,GAEbC,QAAS,CACPxB,MAAO,KACPjB,GAAI,UACJkC,MAAO,UACPC,MAAO,GACPC,OAAOC,EAAAA,EAAAA,KACPC,YAAa,GACbE,WAAW,GAEbE,aAAc,CACZzB,MAAO,KACPjB,GAAI,SACJkC,MAAO,SACPC,MAAO,GACPC,OAAOC,EAAAA,EAAAA,KACPC,YAAa,kBACbE,WAAW,GAEbG,OAAQ,CACN3C,GAAI,SACJkC,MAAO,MACPjB,MAAO,GACP2B,KAAM,KACNC,KAAM,IACNlB,IAAK,EACLmB,IAAK,IACLC,SAAU,EACVX,MAAO,KACFC,EAAAA,EAAAA,SACAX,EAAAA,EAAAA,GAAe,IAEpBc,WAAW,IAGTQ,EAA0C,CAC9CC,WAAY,CACVjD,GAAI,aACJkC,MAAO,yBACPU,KAAM,OACN3B,MAAO,GACPiC,OAAQ,GACRH,SAAU,EACVF,KAAM,GACNlB,IAAK,EACLmB,IAAK,GACLV,OAAOC,EAAAA,EAAAA,KACPG,WAAW,GAEbW,gBAAiB,CACfnD,GAAI,kBACJkC,MAAO,yBACPU,KAAM,IACN3B,MAAO,GACPuB,WAAW,GAEbY,oBAAqB,CACnBpD,GAAI,sBACJkC,MAAO,uBACPU,KAAM,OACN3B,MAAO,GACP8B,SAAU,EACVF,KAAM,GACNlB,IAAK,EACLmB,IAAK,GACLN,WAAW,GAEba,aAAc,CACZrD,GAAI,eACJkC,MAAO,wBACPU,KAAM,IACN3B,MAAO,GACPuB,WAAW,GAEbc,QAAS,CACPrC,MAAO,KACPjB,GAAI,UACJkC,MAAO,uBACPC,MAAO,GACPC,OAAOC,EAAAA,EAAAA,KACPC,YAAa,GACbE,WAAW,GAEbe,SAAU,CACRvD,GAAI,WACJkC,MAAO,uBACPU,KAAM,IACN3B,MAAO,GACPuB,WAAW,GAEbgB,aAAc,CACZxD,GAAI,eACJkC,MAAO,gBACPU,KAAM,IACN3B,MAAO,GACPuB,WAAW,GAEbiB,mBAAoB,CAClBzD,GAAI,qBACJkC,MAAO,oBACPU,KAAM,MACN3B,MAAO,GACPuB,WAAW,GAEbkB,SAAU,CACR1D,GAAI,WACJkC,MAAO,cACPU,KAAM,IACN3B,MAAO,GACPuB,WAAW,GAEbmB,eAAgB,CACd3D,GAAI,iBACJkC,MAAO,kBACPU,KAAM,MACN3B,MAAO,GACPuB,WAAW,GAEboB,QAAS,CACP5D,GAAI,UACJkC,MAAO,eACPU,KAAM,IACN3B,MAAO,GACPuB,WAAW,IAGTqB,EAA0C,CAC9CC,MAAO,CACL9D,GAAI,cACJkC,MAAO,SACPjB,MAAO,QACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,MAET0B,OAAQ,CACN/D,GAAI,eACJkC,MAAO,YACPjB,MAAO,QACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,MAET2B,MAAO,CACLhE,GAAI,cACJkC,MAAO,SACPjB,MAAO,QACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,MAET4B,WAAY,CACVjE,GAAI,mBACJkC,MAAO,aACPjB,MAAO,QACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,MAET6B,MAAO,CACLlE,GAAI,cACJkC,MAAO,YACPjB,MAAO,QACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,OAGL8B,EAAoD,CACxDC,YAAa,CACXnD,MAAO,KACPjB,GAAI,cACJkC,MAAO,mBACPC,MAAO,GACPC,OAAOC,EAAAA,EAAAA,KACPC,YAAa,4BACbE,WAAW,GAEb6B,WAAY,CACVrE,GAAI,aACJkC,MAAO,sBACPM,WAAW,EACXL,MAAO,CACL,CACElB,MAAO,KACPqD,KAAM,OAER,CACErD,MAAO,KACPqD,KAAM,QAGVrD,MAAO,KACPmB,OAAOC,EAAAA,EAAAA,KACPO,KAAM,KAER2B,cAAe,CACbvE,GAAI,gBACJkC,MAAO,kBACPU,KAAM,IACN3B,MAAO,GACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,MAETmC,uBAAwB,CACtBxE,GAAI,yBACJkC,MAAO,gBACPU,KAAM,IACN3B,MAAO,GACP8B,SAAU,EACVF,KAAM,GACNL,WAAW,EACXJ,OAAOC,EAAAA,EAAAA,OAILoC,GAA8CC,EAAAA,EAAAA,IAAS,CAC3D1C,eACAgB,aACAa,aACAc,MAAO,CACLC,YAAa,CACX5E,GAAI,cACJkC,MAAO,iBACPU,KAAM,OACN3B,MAAO,GACP8B,SAAU,EACVF,KAAM,GACNlB,IAAK,EACLmB,IAAK,GACLN,WAAW,GAEbqC,QAAS,CACP7E,GAAI,UACJkC,MAAO,cACPjB,MAAO,GACPmB,OAAO0C,EAAAA,EAAAA,OAGXX,oBAGF,MAAO,CACLM,SACD,E,4CCvUI,MAAMM,EAAkBN,IAC7B,SAASO,IACP,IACGP,EAAOzC,aAAaC,QAAQhB,QAC5BwD,EAAOzC,aAAaS,QAAQxB,QAC5BwD,EAAOzC,aAAaU,aAAazB,QACjCwD,EAAOzB,WAAWM,QAAQrC,QAC1BwD,EAAOzB,WAAWC,WAAWC,OAE9B,OAAO,KAGT,MAAMvD,EAA2B,CAC/BsF,WAAYnD,OAAO2C,EAAOzC,aAAaC,QAAQhB,OAAOA,OACtDiE,OAAQT,EAAOzC,aAAaU,aAAazB,OAAOA,MAChD0B,OAAQb,OAAO2C,EAAOzC,aAAaW,OAAO1B,MAAMQ,QAAQ,MAAO,KAC/DwB,WAAYnB,OAAO2C,EAAOzB,WAAWC,WAAWC,QAChD0B,YAAa9C,OAAO2C,EAAOE,MAAMC,YAAY3D,OAC7CkE,OAAQV,EAAON,gBAAgBC,YAAYnD,MAAQ,EAAI,EACvDL,WAAY,CACVkD,MAAOhC,OAAO2C,EAAOZ,WAAWC,MAAM7C,OACtC+C,MAAOlC,OAAO2C,EAAOZ,WAAWG,MAAM/C,OACtCiD,MAAOpC,OAAO2C,EAAOZ,WAAWK,MAAMjD,OACtC8C,OAAQjC,OAAO2C,EAAOZ,WAAWE,OAAO9C,OACxCgD,WAAYnC,OAAO2C,EAAOZ,WAAWI,WAAWhD,QAElDJ,aAAc,CACZuE,KAAMX,EAAON,gBAAgBC,YAAYnD,OAAOA,OAAS,GACzDoE,MAAOvD,OAAO2C,EAAON,gBAAgBI,cAActD,OACnDqE,SAAUxD,OAAO2C,EAAON,gBAAgBE,WAAWpD,OAAOA,QAE5DR,MAAO,CACLgC,QAASgC,EAAOzC,aAAaS,QAAQxB,MAAMA,MAC3CqC,QAASmB,EAAOzB,WAAWM,QAAQrC,OAAOA,QAwB9C,OApBIwD,EAAOE,MAAME,QAAQ5D,QACvBtB,EAAIkF,QAAUJ,EAAOE,MAAME,QAAQ5D,OAGrCsE,OAAOC,QAAQf,EAAOzB,YACnByC,QACC,EAAEC,EAAKzE,KACLA,EAAMuB,WACE,YAARkD,GACQ,eAARA,GACQ,wBAARA,IAEHC,SAAQ,EAAED,EAAKzE,MACdtB,EAAIc,MAAMiF,GAAOzE,EAAMA,KAAK,IAG5BwD,EAAOzC,aAAaO,MAAMtB,QAC5BtB,EAAIiG,SAAW9D,OAAO2C,EAAOzC,aAAaO,MAAMtB,MAAMA,QAGjDtB,CACT,CAEA,MAAO,CACLqF,cACD,ECzDUa,EAAapB,IACxB,MAAMqB,GAASC,EAAAA,EAAAA,KACTC,GAASC,EAAAA,EAAAA,OACT,YAAEjB,GAAgBD,EAAeN,GAEvC/E,eAAewG,IACb,MAAMC,EAAOnB,IAEb,GAAImB,EAAM,CACRL,EAAOM,KAAKC,EAAAA,EAAoBC,QAChC,MAAM3G,QAAYW,EAAAA,EAAAA,IAAe6F,GAE5BxG,EAAI4G,MAKPT,EAAOM,KAAKC,EAAAA,EAAoBG,MAAO,CACrClC,KAAM3E,EAAIwG,KAAKM,MAAQ,gCALzBX,EAAOM,KAAKC,EAAAA,EAAoBK,QAAS,CACvCC,SAAUA,IAAMX,EAAOY,Q,CAQ/B,CAEAlH,eAAemH,EAAW7G,GACxB,MAAMmG,EAAOnB,IAEb,GAAImB,EAAM,CACRL,EAAOM,KAAKC,EAAAA,EAAoBC,QAChC,MAAM3G,QAAYmB,EAAAA,EAAAA,IAAgB,IAAKqF,EAAMpG,WAAYC,IAEpDL,EAAI4G,MAKPT,EAAOM,KAAKC,EAAAA,EAAoBG,MAAO,CACrClC,KAAM3E,EAAIwG,KAAKM,MAAQ,kCALzBX,EAAOM,KAAKC,EAAAA,EAAoBK,QAAS,CACvCC,SAAUA,IAAMX,EAAOY,Q,CAQ/B,CAEA,MAAO,CACLV,SACAW,aACD,E,oDC9CI,MAAMC,EAAgBrC,IAC3B,MAAM,WAAEsC,IAAeC,EAAAA,EAAAA,KAAYC,EAAAA,EAAAA,MAC7BC,GAAuBC,EAAAA,EAAAA,KAAI,GAEjC,SAASC,IAEL3C,EAAOzC,aAAaS,QAAQxB,OACgB,SAA5CwD,EAAOzC,aAAaS,QAAQxB,MAAMA,OAClCwD,EAAOzB,WAAWM,QAAQrC,OACe,YAAzCwD,EAAOzB,WAAWM,QAAQrC,MAAMA,QAEhCwD,EAAOzB,WAAWO,SAAStC,MAAQoG,OACjC,IAAMvF,OAAO2C,EAAOzB,WAAWK,aAAapC,QAElD,CAEA,SAASqG,EAA4BC,GACnC,IAAKL,EAAqBjG,MAAO,CAC/BiG,EAAqBjG,OAAQ,EAE7B,MAAMuG,EAAY1F,OAAO2C,EAAOzB,WAAWC,WAAWhC,OAChDwG,EAAkB3F,OAAO2C,EAAOzB,WAAWC,WAAWC,QAExDqE,GAEF9C,EAAOzB,WAAWC,WAAWC,OAASsE,EAAUE,QAAQ,GACxDjD,EAAOzB,WAAWC,WAAWhC,MAAQuG,EAAUE,QAAQ,KAEnDD,GAAmBhD,EAAOzB,WAAWC,WAAWH,KAAO,IAGhD2E,GAAmBhD,EAAOzB,WAAWC,WAAWtB,KAAO,MADhE8C,EAAOzB,WAAWC,WAAWC,OAASsE,EAAUE,QAAQ,IAO5DjD,EAAOzB,WAAWI,oBAAoBnC,OACpCuG,IAAcT,EAAW9F,MAAM0G,MAAMrC,UAAYvE,EAAAA,GAAO,KACxDyG,GACAE,QAAQ,IAEVE,EAAAA,EAAAA,MAAWC,MAAK,KACdX,EAAqBjG,OAAQ,CAAK,G,CAGxC,CAEA,SAAS6G,IACP,IAAKZ,EAAqBjG,MAAO,CAC/BiG,EAAqBjG,OAAQ,EAE7B,MAAM8G,EAAmBjG,OACvB2C,EAAOzB,WAAWI,oBAAoBnC,OAElCiC,EACJ6E,GAAoB,GAAKhB,EAAW9F,MAAM0G,MAAMrC,UAAYvE,EAAAA,GAAO,KAErE0D,EAAOzB,WAAWC,WAAWC,OAASA,EAAOwE,QAAQ,GACrDjD,EAAOzB,WAAWC,WAAWhC,MAAQiC,EAAOwE,QAAQ,IAEpDE,EAAAA,EAAAA,MAAWC,MAAK,KACdX,EAAqBjG,OAAQ,CAAK,G,CAGxC,CAEA,MAAM+G,GAA8Bb,EAAAA,EAAAA,KAAI,GACxCzH,eAAeuI,IACb,IAAKD,EAA4B/G,MAAO,CACtC+G,EAA4B/G,OAAQ,EAEpC,MAAMiH,EAAMpG,OAAO2C,EAAON,gBAAgBE,WAAWpD,OAAOA,OAEvDiH,IAAOC,MAAMD,KAChBzD,EAAON,gBAAgBK,uBAAuBvD,OAC5CD,EAAAA,EAAAA,GACEyD,EAAON,gBAAgBI,cAActD,MACrCwD,EAAON,gBAAgBK,uBAAuBzB,WAIpD,MAAMqF,EAAStG,OAAO2C,EAAON,gBAAgBI,cAActD,OAC3DwD,EAAON,gBAAgBK,uBAAuBvD,OAC5CD,EAAAA,EAAAA,GAAyBoH,GAAUF,EAAM,KAAOE,EAAQ,SAEpDR,EAAAA,EAAAA,MACNI,EAA4B/G,OAAQ,C,CAExC,CACAvB,eAAe2I,IACb,IAAKL,EAA4B/G,MAAO,CACtC+G,EAA4B/G,OAAQ,EAEpC,MAAMiH,EAAMpG,OAAO2C,EAAON,gBAAgBE,WAAWpD,OAAOA,OAEvDiH,IAAOC,MAAMD,KAChBzD,EAAON,gBAAgBI,cAActD,OAAQD,EAAAA,EAAAA,GAC3CyD,EAAON,gBAAgBK,uBAAuBvD,MAC9C,IAIJ,MAAMmH,EAAStG,OACb2C,EAAON,gBAAgBK,uBAAuBvD,OAEhDwD,EAAON,gBAAgBI,cAActD,OAAQD,EAAAA,EAAAA,GAC3CoH,GAAU,EAAIF,EAAM,KACpB,SAGIN,EAAAA,EAAAA,MACNI,EAA4B/G,OAAQ,C,CAExC,CAEA,MAAO,CACLmG,qBACAU,uBACAR,8BACAW,0BACAI,iCACD,EC7HUC,EAAiB7D,IAC5B,MAAM,WAAEsC,IAAeC,EAAAA,EAAAA,KAAYC,EAAAA,EAAAA,MAEnC,SAASsB,IACP,MAAMjF,EAAUyD,EAAW9F,MAAM0G,MAAMrE,QACjCkF,EACJzB,EAAW9F,MAAM0G,MAAMa,6BAiBzB,GAfA/D,EAAOzB,WAAWM,QAAQnB,MAAQoD,OAAOC,QAAQlC,GAC9CmC,QAAO,EAAEgD,EAAGC,OACXjE,EAAOzC,aAAaS,QAAQxB,OAAOA,OAC/BuH,EACE/D,EAAOzC,aAAaS,QAAQxB,MAAMA,OAClC0H,MAAMC,GAAOA,IAAOH,MAG3BI,KACC,EAAEnD,EAAKzE,MAAM,CACXA,MAAOyE,EACPpB,KAAMrD,MAIqC,SAA7CwD,EAAOzC,aAAaS,QAAQxB,OAAOA,MAAkB,CACvD,MAAM6H,EAAgBrE,EAAOzB,WAAWM,QAAQnB,MAAM4G,MACnDH,GAAoB,aAAbA,EAAG3H,QAEb,GAAI6H,EACFrE,EAAOzB,WAAWM,QAAQrC,MAAQ6H,MAC7B,CACL,MAAME,EAAsBvE,EAAOzB,WAAWM,QAAQnB,MAAM4G,MACzDH,GAAoB,oBAAbA,EAAG3H,QAEb+H,IACGvE,EAAOzB,WAAWM,QAAQrC,MAAQ+H,E,MAElC,CACL,MAAMA,EAAsBvE,EAAOzB,WAAWM,QAAQnB,MAAM4G,MACzDH,GAAoB,oBAAbA,EAAG3H,QAEb+H,IACGvE,EAAOzB,WAAWM,QAAQrC,MAAQ+H,E,CAEzC,CAEA,MAAO,CACLT,aACD,E,kCChDI,MAAMU,EACXxE,IAEA,MAAM,WAAEsC,IAAeC,EAAAA,EAAAA,KAAYC,EAAAA,EAAAA,MAEnC,SAASiC,IACP,MAAMC,EAAapC,EAAW9F,MAAM0G,MAAMyB,SAEpCC,EAAc,CAClB,eACA,kBACA,WACA,eACA,iBACA,WACA,UACA,qBACA,gBAGFA,EAAY1D,SAASzF,IAEfuE,EAAOzB,WAAW9C,KAEpBuE,EAAOzB,WAAW9C,GAAMsC,WAAY,E,IAIxC,MAAM8G,EAAiBC,IACrB,MAAMjG,EAAUmB,EAAOzB,WAAWM,QAAQrC,OAAOA,OAAS,GACpDwB,EAAUgC,EAAOzC,aAAaS,QAAQxB,OAAOA,OAAS,GAEtDuI,EAAiB/E,EAAO8E,GACxBE,EAAkBlE,OAAOC,QAAQ2D,GACvC,GAAIK,EAAgB,CAClB,MAAME,EAAiBnE,OAAOC,QAAQgE,GAAgB/D,QACpD,EAAEC,EAAKzE,KAAWwI,EAAgBd,MAAK,EAAEgB,EAAGC,KAASD,IAAMjE,MAE7DgE,EAAe/D,SAAQ,EAAED,EAAKzE,MAE5BA,EAAMA,MAAQ,EAAE,G,CAIpBwI,EAAgB9D,SAAQ,EAAED,EAAKzE,MAE7B,MAAM4I,EAAQpF,EAAO8E,GAAU7D,GACzBrF,EAASY,EAAM6I,KAAKxG,KAAWb,GACjCoH,GAASxJ,IACW,kBAAfA,EAAOyC,IACT+G,EAAM/G,IAAMzC,EAAOyC,WACb+G,EAAM/G,IAES,kBAAfzC,EAAOsB,IAChBkI,EAAMlI,IAAMtB,EAAOsB,WAEZkI,EAAMlI,IAGW,kBAAftB,EAAO0J,KAChBF,EAAMlI,IAAMtB,EAAO0J,IACnBF,EAAM/G,IAAMzC,EAAO0J,IACnBF,EAAME,IAAM1J,EAAO0J,YAEZF,EAAME,IAEa,kBAArB1J,EAAO2J,UACTH,EAAM9G,SAAW1C,EAAO2J,iBAClBH,EAAM9G,SACM,kBAAhB1C,EAAOwC,KACTgH,EAAMhH,KAAOxC,EAAOwC,YACdgH,EAAMhH,KAEjBgH,EAAMrH,WAAY,OAECyH,IAAf5J,EAAO6J,IACTL,EAAM5I,MACsB,kBAAnB4I,EAAM9G,SACT1C,EAAO6J,IAAIxC,QAAQmC,EAAM9G,UACzBsE,OAAOhH,EAAO6J,KAEpBL,EAAM5I,MACkB,kBAAfZ,EAAO0J,IACgB,kBAAnBF,EAAM9G,SACX1C,EAAO0J,IAAIrC,QAAQmC,EAAM9G,UACzBsE,OAAOhH,EAAO0J,KAChB,GAIRtF,EAAO8E,GAAU7D,GAAOmE,E,GAE1B,EAGJP,EAAc,cAGZxH,OAAO2C,EAAOzB,WAAWK,aAAapC,OACpCa,OAAO2C,EAAOzB,WAAWO,SAAStC,OACpC,MAEAwD,EAAOzB,WAAWO,SAAStC,MAAQoG,OACjC,IAAMvF,OAAO2C,EAAOzB,WAAWK,aAAapC,QAGlD,CAEA,MAAO,CACLiI,gBACD,E,cC5GI,MAAMiB,EAAkBA,CAC7B1F,EACA2F,EACAC,KAEA,MAAMC,GAAaC,EAAAA,EAAAA,KAEnB7K,eAAe8K,IACb/F,EAAOzC,aAAaO,MAAMtB,MAAQ,KAElC,MAAMgE,EAAqBwF,SACzBhG,EAAOzC,aAAaC,QAAQhB,OAAOA,OAAS,WAGxCqJ,EAAWI,eACjB,MAAMC,EACJL,EAAWM,UAAU,CAAE3F,WAAYA,EAAY4F,SAAS,KAAW,GAiBrE,GAfApG,EAAOzC,aAAaO,MAAMJ,MACxBwI,EACGlF,QAAQqF,GAAMA,EAAEC,eAAeC,SAC/BnC,KAAKiC,IAAC,CACL7J,MAAOoG,OAAOyD,EAAElF,UAChBtB,KAAMwG,EAAE5K,UACH,GAEXuE,EAAOzC,aAAaO,MAAMC,YACtBiC,EAAOzC,aAAaO,MAAMJ,MAAM6I,OAEW,IAA3CvG,EAAOzC,aAAaO,MAAMJ,MAAM6I,SAClCvG,EAAOzC,aAAaO,MAAMtB,MAAQwD,EAAOzC,aAAaO,MAAMJ,MAAM,KAG/DiI,EAAOnJ,OAASoJ,EAAYpJ,MAAO,CACtC,MAAMgK,EAAQxG,EAAOzC,aAAaO,MAAMJ,MAAM4G,MAC3CH,GAAOA,EAAG3H,QAAUoG,OAAOgD,EAAYpJ,MAAOsB,MAAMqD,YAEvDqF,IAAUxG,EAAOzC,aAAaO,MAAMtB,MAAQgK,E,CAEhD,CAEA,MAAO,CACLT,eACD,ECnCUU,EAAUA,CACrBzG,EACA2F,EACAC,EACAc,KAEA,MAAMrF,GAASC,EAAAA,EAAAA,MACT,WAAEgB,IAAeC,EAAAA,EAAAA,KAAYC,EAAAA,EAAAA,MAC7BmE,GAAeC,EAAAA,EAAAA,MACf,gBAAEC,EAAe,SAAEC,IAAavE,EAAAA,EAAAA,IAAYoE,IAC5C,WAAE7C,GAAeD,EAAc7D,IAC/B,aAAE+F,GAAiBL,EAAgB1F,EAAQ2F,EAAQC,IACnD,cAAEnB,GAAkBD,EAAiBxE,IACrC,cACJ+G,EAAa,YACbC,EAAW,cACXC,EAAa,cACbC,EAAa,aACbC,IACEC,EAAAA,EAAAA,GAAUzB,GAEd1K,eAAeoM,IACb,IAAIC,EAAMC,EAAWC,EAASxJ,EAASa,EAAS4B,EAC5CmF,EAAYpJ,QACd8K,GAAO,EACPC,EAAY3B,EAAYpJ,MAAMgB,QAAQgD,WACtCgH,EAAU5B,EAAYpJ,MAAMsB,MAAMqD,SAClCnD,EAAU4H,EAAYpJ,MAAMwB,QAC5Ba,EAAU+G,EAAYpJ,MAAMqC,QAC5B4B,EAASmF,EAAYpJ,MAAMiE,cAEvBsG,EAAc/G,EAAOzC,aAAaC,QAAS+J,IAC5CD,GAAQtH,EAAOzC,aAAaC,QAAQhB,QACvC+K,EAAYvB,SAAShG,EAAOzC,aAAaC,QAAQhB,MAAMA,cAEnDwK,EAAYhH,EAAOzC,aAAaO,MAAO,UAAWyJ,EAAWC,IAC9DF,GAAQtH,EAAOzC,aAAaO,MAAMtB,QACrCgL,EAAUxB,SAAShG,EAAOzC,aAAaO,MAAMtB,MAAMA,cAE/CyK,EACJjH,EAAOzC,aAAaS,QACpB,UACAwJ,EACAxJ,GAEF,MAAMyJ,EAAYzH,EAAOzC,aAAaS,QAAQxB,MAC1CwD,EAAOzC,aAAaS,QAAQxB,MAAMA,WAClCgJ,QACE0B,EAAclH,EAAOzB,WAAWM,QAAS4I,EAAW5I,SACpDsI,EAAanH,EAAOzC,aAAaU,aAAc,UAAWwC,GAC5DT,EAAOzC,aAAaS,QAAQxB,OAAOiI,GACzC,CAEAxJ,eAAeyM,UACPL,IAENrH,EAAON,gBAAgBC,YAAYjC,MAAMiK,QACpC7G,OAAOC,QAAQuB,EAAW9F,MAAMoL,QAAQjI,aAAayE,KACtD,EAAEnD,EAAKzE,MAGN,CACCA,MAAOyE,EACPpB,KAAMrD,EAAMqL,UAIlB,MAAMC,EAAc9H,EAAON,gBAAgBC,YAAYjC,MAAM4G,MAC1DH,GAAoB,eAAbA,EAAG3H,QAETsL,IACF9H,EAAON,gBAAgBC,YAAYnD,MAAQsL,GAG7C9H,EAAON,gBAAgBE,WAAWpD,MAChCwD,EAAON,gBAAgBE,WAAWlC,MAAM4G,MAAMH,GAAoB,OAAbA,EAAG3H,SACxD,IAGJ,CAEAvB,eAAe6H,IACbzB,EAAOM,KAAKC,EAAAA,EAAoBC,cAE1B6F,IACN/B,EAAOnJ,OAAQ,QAET2G,EAAAA,EAAAA,MACNuD,IACArF,EAAO0G,OACT,CAEA,MAAO,CACLjF,OACD,EC3EUkF,EAAWA,CACtBhI,EACAiI,KAEA,MAAMC,GAAYxF,EAAAA,EAAAA,KAAI,IAChB,cACJuE,EAAa,YACbD,EAAW,cACXE,EAAa,cACbzC,EAAa,qBACbpB,EAAoB,4BACpBR,EAA2B,mBAC3BF,EAAkB,wBAClBa,EAAuB,+BACvBI,GACEqE,EAEJ,SAASvB,KACPyB,EAAAA,EAAAA,KACE,IAAMnI,EAAOzC,aAAaC,QAAQhB,OAAOA,QACzCvB,UACE,GAAIiN,EAAU1L,MAAO,OAErB,MAAM+K,EAAYa,EAAWpC,SAASoC,QAAY5C,QAC5CwB,EAAYhH,EAAOzC,aAAaO,MAAO,UAAWyJ,EAAU,KAItEY,EAAAA,EAAAA,KACE,IAAMnI,EAAOzC,aAAaO,MAAMtB,OAAOA,QACvCvB,UACE,GAAIiN,EAAU1L,MAAO,OAErB,MAAMgL,EAAUY,EAAWpC,SAASoC,QAAY5C,QAC1CyB,EAAcjH,EAAOzC,aAAaS,QAAS,UAAWwJ,EAAQ,KAGxEW,EAAAA,EAAAA,KACE,IAAMnI,EAAOzC,aAAaS,QAAQxB,QAClCvB,UACE,GAAIiN,EAAU1L,MAAO,OAErB,MAAMiL,EAAYzH,EAAOzC,aAAaS,QAAQxB,MAC1CwD,EAAOzC,aAAaS,QAAQxB,MAAMA,WAClCgJ,QACE0B,EAAclH,EAAOzB,WAAWM,QAAS4I,GAC/ChD,GAAe,KAGnB0D,EAAAA,EAAAA,KACE,IAAMnI,EAAOzB,WAAWM,QAAQrC,QAChC,KACM0L,EAAU1L,OAEdiI,GAAe,KAGnB0D,EAAAA,EAAAA,KACE,IAAMnI,EAAOzB,WAAWK,aAAapC,QACrC,KACM0L,EAAU1L,OACdmG,GAAoB,KAGxBwF,EAAAA,EAAAA,KACE,IAAM,CACJnI,EAAOzB,WAAWC,WAAWhC,MAC7BwD,EAAOzB,WAAWC,WAAWC,UAE/B,EAAE,CAAE4J,IAAU,CAAEC,MACVJ,EAAU1L,OACV6L,IAAWC,GAASzF,GAA6B,KAGzDsF,EAAAA,EAAAA,KACE,IAAMnI,EAAOzB,WAAWI,oBAAoBnC,QAC5C,KACM0L,EAAU1L,OAEd6G,GAAsB,KAG1B8E,EAAAA,EAAAA,KACE,IAAM,CACJnI,EAAON,gBAAgBE,WAAWpD,MAClCwD,EAAON,gBAAgBI,cAActD,SAEvCvB,UACMiN,EAAU1L,aAERgH,GAAyB,KAGnC2E,EAAAA,EAAAA,KACE,IAAMnI,EAAON,gBAAgBK,uBAAuBvD,QACpDvB,UACMiN,EAAU1L,aAERoH,GAAgC,GAG5C,CAEA,MAAO,CACL8C,cACA6B,aAAcA,IAAOL,EAAU1L,OAAQ,EACvCgM,eAAgBA,IAAON,EAAU1L,OAAQ,EAC1C,ECnIUiM,EAAcA,CACzBzI,EACA4F,EACAD,EACA4C,EACAC,KAEA,MAAM,aAAEzC,GAAiBL,EAAgB1F,EAAQ2F,EAAQC,IACnD,WAAE9B,GAAeD,EAAc7D,IAC/B,cAAEyE,GAAkBD,EAAiBxE,IACrC,4BAAE6C,EAA2B,wBAAEW,GACnCnB,EAAarC,GAEf/E,eAAeyN,IACb,IAAK9C,EAAYpJ,MAAO,OAExBmJ,EAAOnJ,OAAQ,EACf+L,IAgBAvI,EAAOzC,aAAaW,OAAO1B,OAAQD,EAAAA,EAAAA,GACjCqJ,EAAYpJ,MAAO0B,QAGrB8B,EAAOzB,WAAWC,WAAWhC,MAAQoG,OAAOgD,EAAYpJ,MAAOgC,YAC/DqE,GAA4B,GAE5B/B,OAAOC,QAAQf,EAAOZ,YAAYgF,KAAI,EAAEuE,EAAMC,MAC5C,MAAMpC,EAAQZ,EAAYpJ,OAAOL,WAAWwM,GACxCnC,IACFoC,EAAIpM,MAAQgK,EAAMvD,QAAQ,G,IAI9B2C,EAAYpJ,OAAO2D,cAChBH,EAAOE,MAAMC,YAAY3D,MAAQoG,OAAOgD,EAAYpJ,MAAO2D,cAE9D,MAAMvE,EAASgK,EAAYpJ,OAAOR,MAclC,GAbIJ,IACFA,EAAOmD,eACJiB,EAAOzB,WAAWQ,aAAavC,MAAQoG,OAAOhH,EAAOmD,eACxDnD,EAAOqD,WACJe,EAAOzB,WAAWU,SAASzC,MAAQoG,OAAOhH,EAAOqD,WACpDrD,EAAOgD,eACJoB,EAAOzB,WAAWK,aAAapC,MAAQoG,OAAOhH,EAAOgD,eACxDhD,EAAOkD,WACJkB,EAAOzB,WAAWO,SAAStC,MAAQoG,OAAOhH,EAAOkD,WACpDlD,EAAOuD,UACJa,EAAOzB,WAAWY,QAAQ3C,MAAQoG,OAAOhH,EAAOuD,WAGjDyG,EAAYpJ,OAAOkE,QAAUkF,EAAYpJ,OAAOJ,aAAc,CAChE,MAAMyM,EAAY7I,EAAON,gBAAgBC,YAAYjC,MAAM4G,MACxD3D,GAASA,EAAKnE,QAAUoJ,EAAYpJ,MAAOJ,aAAauE,OAE3DkI,IAAc7I,EAAON,gBAAgBC,YAAYnD,MAAQqM,GACzD,MAAMC,EAAW9I,EAAON,gBAAgBE,WAAWlC,MAAM4G,MACtDH,GAAOA,EAAG3H,QAAUoG,OAAOgD,EAAYpJ,OAAOJ,aAAayE,YAE1DiI,IACF9I,EAAON,gBAAgBE,WAAWpD,MAAQsM,GAG5C9I,EAAON,gBAAgBI,cAActD,OAAQD,EAAAA,EAAAA,GAC3CqJ,EAAYpJ,OAAOJ,aAAawE,MAChCZ,EAAON,gBAAgBI,cAAcxB,gBAGjCkF,G,CAGRoC,EAAYpJ,OAAO4D,UAChBJ,EAAOE,MAAME,QAAQ5D,MAAQoJ,EAAYpJ,OAAO4D,eAE7C+C,EAAAA,EAAAA,MACNwC,EAAOnJ,OAAQ,EACfgM,GACF,CAEA,MAAO,CACLE,WACD,ECpGUK,EAAUA,KACrB,MAAMnD,GAA0ClD,EAAAA,EAAAA,IAAI,MAEpDzH,eAAe+N,EAAUzN,GACvB,MAAML,QAAYQ,EAAAA,EAAAA,IAAcH,IAE3BL,EAAI4G,OAAS5G,EAAIwG,KAAKM,OACzB4D,EAAYpJ,MAAQtB,EAAIwG,KAAKM,KAEjC,CAEA,MAAO,CACLgH,YACApD,cACD,ECLUqD,EAAiBA,KAC5B,MAAM,YAAEC,EAAW,aAAEC,EAAY,iBAAEC,IAAqBC,EAAAA,EAAAA,KAClD1D,GAASjD,EAAAA,EAAAA,KAAI,GACb4G,GAAY5G,EAAAA,EAAAA,KAAI,IAEhB,OAAE1C,GAAW1C,KACb,YAAEsI,EAAW,UAAEoD,GAAcD,KAC7B,OAAEtH,EAAM,WAAEW,GAAehB,EAAUpB,IACnC,WAAE8D,GAAeD,EAAc7D,IAC/B,YAAEgH,EAAW,cAAEC,EAAa,cAAEC,EAAa,aAAEC,IACjDC,EAAAA,EAAAA,GAAUzB,IACN,cAAElB,GAAkBD,EAAiBxE,IAErC,mBACJ2C,EAAkB,4BAClBE,EAA2B,wBAC3BW,EAAuB,+BACvBI,EAA8B,qBAC9BP,GACEhB,EAAarC,IAEX,YAAE0G,EAAW,aAAE6B,EAAY,eAAEC,GAAmBR,EAAShI,EAAQ,CACrE2C,qBACAE,8BACAQ,uBACAO,iCACAJ,0BACAyD,gBACAD,cACAE,gBACAzC,mBAGI,KAAE3B,GAAS2D,EAAQzG,EAAQ2F,EAAQC,EAAac,IAChD,SAAEgC,GAAaD,EACnBzI,EACA4F,EACAD,EACA4C,EACAC,GAGF,MAAO,CACLxI,SACAkJ,cACAC,eACAC,mBACAtG,OACAkG,YACAN,WACA/C,SACAlE,SACAW,aACAkH,YACD,C,+HChEH,MAAMC,EAAa,CAAEC,MAAO,uBACtBC,EAAa,CACjBD,MAAO,qBACPE,MAAO,CAAC,WAAa,YA6BvB,OAA4BC,EAAAA,EAAAA,IAAiB,CAC3CC,OAAQ,iBACRC,MAAO,CACLpM,MAAO,CAAC,EACRI,YAAa,CAAC,EACdtC,GAAI,CAAC,EACLiB,MAAO,CAAC,EACRiC,OAAQ,CAAC,EACTqL,KAAM,CAAC,EACPnM,MAAO,CAAC,EACRoM,KAAM,CAAC,EACPC,SAAU,CAAED,KAAME,SAClB7L,KAAM,CAAE8L,QAAS,GACjBhN,IAAK,CAAC,EACNmB,IAAK,CAAC,EACNC,SAAU,CAAC,EACX6L,OAAQ,CAAC,EACTC,eAAgB,CAAEL,KAAME,UAE1BI,MAAO,CAAC,eAAgB,QAAS,QACjCC,KAAAA,CAAMC,GAAgBC,OAAQC,EAAQ,KAAEC,IAE1C,MAAMb,EAAQU,EAERI,GAAQC,EAAAA,EAAAA,KAKRC,IAFSnI,EAAAA,EAAAA,KAAI,IAERoI,EAAAA,EAAAA,IACT,CAAEjB,MAAO,CAAErN,MAAOqN,EAAMlM,OAAS,CAAC,IAClC,CACEkM,WAIEkB,GAAkBC,EAAAA,EAAAA,KAAS,MAC/BH,EAAGrO,MAAMyO,QAAQ1E,SAKb/J,GAAQwO,EAAAA,EAAAA,IAAS,CACrB5P,GAAAA,GACE,OAAOyO,EAAMrN,KACf,EACA0O,GAAAA,CAAI1O,GACFkO,EAAK,eAAgBlO,EAAMQ,QAAQ,IAAK,KAC1C,IAGF/B,eAAekQ,IACb,MAAMC,QAAgBP,EAAGrO,MAAM6O,YAQ/B,OAPKD,GACHT,EAAMW,IAAI,CACRC,SAAU,QACVC,QAAS3B,EAAMpM,MACfgO,OAAQZ,EAAGrO,MAAMyO,QAAQ,GAAGS,WAGzBN,CACT,CAEA,SAASO,IACPd,EAAGrO,MAAMoP,QACX,CAEA3Q,eAAe4Q,EAAOtQ,SACd4H,EAAAA,EAAAA,MACN2I,OAAOC,oBAAoB,QAASC,GACzB,eAAPzQ,GACFmP,EAAK,OAAQlO,EAAMA,OAErBA,EAAMA,MAAQqN,EAAMO,gBAChB7N,EAAAA,EAAAA,GAAyB0P,EAAMzP,EAAMA,OAAQqN,EAAMvL,UAAY,GAC/D2N,EAAMzP,EAAMA,MAClB,CACA,SAAS0P,EAAQ3Q,GACJ,eAAPA,GACFmP,EAAK,SAEPoB,OAAOK,iBAAiB,QAASH,EACnC,CAEA,SAASC,EAAMzP,GACb,IAAItB,EAAMmC,OAAOuF,OAAOpG,GAAOQ,QAAQ,MAAO,IAAIA,QAAQ,IAAK,MAGxC,kBAAd6M,EAAMxL,KACQ,kBAAdwL,EAAM3M,KACb2M,EAAMxL,MAAQwL,EAAM3M,IAEpBhC,EAAM2O,EAAMxL,KAEa,kBAAdwL,EAAMxL,KAAoBnD,EAAM2O,EAAMxL,MAC/CnD,EAAM2O,EAAMxL,KAGW,kBAAdwL,EAAM3M,KAAoBhC,EAAM2O,EAAM3M,MAC/ChC,EAAM2O,EAAM3M,MAIhB,IAAIkP,EAAS/O,OAAOqG,MAAMxI,GACtB,IAC0B,kBAAnB2O,EAAMvL,SACbpD,EAAI+H,QAAQ4G,EAAMvL,UAClBsE,OAAO1H,GAEX,OAAOkR,CACT,CAEA,SAASJ,EAAUK,GACC,KAAdA,EAAEC,QAIY,KAAdD,EAAEC,SACJC,IAJAC,GAOJ,CAEA,SAASC,EAAMjQ,GACb,OAAOA,EAAMQ,QAAQ,IAAK,KAAKyP,MAAM,IACvC,CAEA,SAASD,IACP,MAAMrH,EAAM8G,EAAMzP,EAAMA,OAClBkQ,EAASD,EAAMtH,GACf7G,EAAWuL,EAAMvL,UAAYoO,EAAO,GAAKA,EAAO,GAAGnG,OAAS,EAClE,IAAIoG,EAAM,IACV,IAAK,IAAIC,EAAI,EAAGA,EAAItO,EAAUsO,IAC5BD,GAAO,IAET,MAAME,EAAchD,EAAMvL,SACtBjB,OAAOA,OAAO8H,GAAKlC,QAAQ4G,EAAMvL,WACjCjB,OAAO8H,GACX,IAAIjK,GACD2R,EAAcxP,OAAOsP,GAAO9C,EAAMzL,KAAOf,OAAOsP,IAAQtP,OAAOsP,GAE9D9C,EAAMxL,KAAOnD,EAAM2O,EAAMxL,MAC3BnD,EAAM2O,EAAMxL,KAGd7B,EAAMA,MAAQyP,EAAMrJ,OAAO1H,GAC7B,CACA,SAASqR,IACP,MAAMpH,EAAM8G,EAAMzP,EAAMA,OAClBkQ,EAASD,EAAMtH,GACf7G,EAAWuL,EAAMvL,UAAYoO,EAAO,GAAKA,EAAO,GAAGnG,OAAS,EAClE,IAAIoG,EAAM,IACV,IAAK,IAAIC,EAAI,EAAGA,EAAItO,EAAUsO,IAC5BD,GAAO,IAET,MAAME,EAAchD,EAAMvL,SACtBjB,OAAOA,OAAO8H,GAAKlC,QAAQ4G,EAAMvL,WACjCjB,OAAO8H,GACX,IAAIjK,GACD2R,EAAcxP,OAAOsP,GAAO9C,EAAMzL,KAAOf,OAAOsP,IAAQtP,OAAOsP,GAE9D9C,EAAM3M,KAAOhC,EAAM2O,EAAM3M,MAC3BhC,EAAM2O,EAAM3M,KAGdV,EAAMA,MAAQyP,EAAMrJ,OAAO1H,GAC7B,CAIA,OAFAuP,EAAoB,CAAEU,WAAUQ,kBAAiBpQ,GAAIsO,EAAMtO,KAEpD,CAACuR,EAAUC,KAChB,MAAMC,GAAuBC,EAAAA,EAAAA,IAAkB,aAE/C,OAAQC,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAaC,EAAAA,EAAU,CAC3C7R,GAAIsO,EAAMtO,GACVkC,MAAOoM,EAAMpM,OACZ,CACDyM,SAASmD,EAAAA,EAAAA,KAAS,IAAM,EACtBC,EAAAA,EAAAA,GAAoB,MAAO/D,EAAY,EACrCgE,EAAAA,EAAAA,IAAaP,EAAsB,CACjCQ,WAAYhR,EAAMA,MAClB,sBAAuBuQ,EAAO,KAAOA,EAAO,GAAMU,GAAkBjR,EAAOA,MAAQiR,GACnFlS,GAAIsO,EAAMtO,GACViO,OAAOkE,EAAAA,EAAAA,IAAgB,CAAC,QAAS,CAAE,YAAa3C,EAAgBvO,SAChEqB,YAAagM,EAAMhM,YACnBmM,SAAU8C,EAAK9C,SACfkC,QAASa,EAAO,KAAOA,EAAO,GAAMU,GAAiBvB,EAAQrC,EAAMtO,KACnEsQ,OAAQkB,EAAO,KAAOA,EAAO,GAAMU,GAAiB5B,EAAOhC,EAAMtO,MAChE,KAAM,EAAG,CAAC,aAAc,KAAM,QAAS,cAAe,cACzD+R,EAAAA,EAAAA,GAAoB,OAAQ7D,GAAYkE,EAAAA,EAAAA,IAAiB9D,EAAMM,QAAS,QAG5ElG,EAAG,GACF,EAAG,CAAC,KAAM,SAAS,CAExB,ICnOA,MAAM2J,EAAc,EAEpB,O","sources":["webpack://lac/./src/kernel/api/methods/Request.ts","webpack://lac/./src/kernel/constants/Vat.ts","webpack://lac/./src/kernel/lib/NumberFormat.ts","webpack://lac/./src/kernel/validation/vuelidate/minNumberRules.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useFields.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/usePrepareData.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useSubmit.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useCalculate.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useSetFormula.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useInitialParams.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useUpdatePoints.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useInit.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useWatch.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useFillForm.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/use/useData.ts","webpack://lac/./src/views/modules/CrudForms/LacRequestForm/useRequestForm.ts","webpack://lac/./src/views/components/form/input/LacInputNumber.vue?b4a7","webpack://lac/./src/views/components/form/input/LacInputNumber.vue"],"sourcesContent":["import { getHttp } from \"@/kernel/api/http\";\r\nimport { ApiResponseType, ApiRequestListOptionsType } from \"@/kernel/api/types\";\r\nimport { NotRequestException } from \"@/kernel/lib/exceptions/not-request.exception\";\r\nimport {\r\n  RequestGetData,\r\n  RequestAddData,\r\n  RequestEditData,\r\n} from \"@/kernel/api/dto/Request\";\r\n\r\nexport const getRequestDelete = async (\r\n  id: number\r\n): Promise<ApiResponseType> => {\r\n  const res = await getHttp().get<ApiResponseType | false>(\"/request/delete\", {\r\n    searchParams: {\r\n      request_id: id,\r\n    },\r\n  });\r\n\r\n  if (!res) {\r\n    throw new NotRequestException(getRequestDelete.name);\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport const getRequestGet = async (\r\n  id: number\r\n): Promise<ApiResponseType<RequestGetData>> => {\r\n  const res = await getHttp().get<ApiResponseType<RequestGetData> | false>(\r\n    \"/request/get\",\r\n    {\r\n      searchParams: {\r\n        request_id: id,\r\n      },\r\n    }\r\n  );\r\n\r\n  if (!res) {\r\n    throw new NotRequestException(getRequestGet.name);\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport const getRequestList = async (\r\n  params?: ApiRequestListOptionsType\r\n): Promise<ApiResponseType<RequestGetData[]>> => {\r\n  const res = await getHttp().get<ApiResponseType<RequestGetData[]> | false>(\r\n    \"/request/list\",\r\n    { searchParams: { ...params } }\r\n  );\r\n\r\n  if (!res) {\r\n    throw new NotRequestException(getRequestList.name);\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport const postRequestAdd = async (\r\n  payload: RequestAddData\r\n): Promise<ApiResponseType> => {\r\n  const res = await getHttp().post<ApiResponseType | false>(\"/request/add\", {\r\n    ...payload,\r\n    param: JSON.stringify(payload.param),\r\n    class_rate: JSON.stringify(payload.class_rate),\r\n    payoff_param: JSON.stringify(payload.payoff_param),\r\n  });\r\n\r\n  if (!res) {\r\n    throw new NotRequestException(postRequestAdd.name);\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport const postRequestEdit = async (\r\n  payload: RequestEditData\r\n): Promise<ApiResponseType> => {\r\n  const res = await getHttp().post<ApiResponseType | false>(\"/request/edit\", {\r\n    ...payload,\r\n    param: JSON.stringify(payload.param),\r\n    class_rate: JSON.stringify(payload.class_rate),\r\n    payoff_param: JSON.stringify(payload.payoff_param),\r\n  });\r\n\r\n  if (!res) {\r\n    throw new NotRequestException(postRequestEdit.name);\r\n  }\r\n\r\n  return res;\r\n};\r\n","export const VAT = 10;\r\n","export const numberPrettify = (value: number | string) =>\r\n  new Intl.NumberFormat(\"ru-RU\").format(\r\n    typeof value === \"string\"\r\n      ? +value.replaceAll(/\\s/g, \"\").replace(\",\", \".\")\r\n      : value\r\n  );\r\nexport const numberPrettifyWithDigits = (\r\n  value: number | string,\r\n  digits = 0\r\n) => {\r\n  return new Intl.NumberFormat(\"ru-RU\", {\r\n    minimumFractionDigits: digits,\r\n    maximumFractionDigits: digits,\r\n  })\r\n    .format(\r\n      typeof value === \"string\"\r\n        ? +value.replaceAll(/\\s/g, \"\").replace(\",\", \".\")\r\n        : value\r\n    )\r\n    .replace(\",\", \".\");\r\n};\r\n","import { helpers } from \"@vuelidate/validators\";\r\n\r\nexport const minNumberRules = (min?: number) => ({\r\n  min: helpers.withMessage(\r\n    `Минимальное значение ${min || 0}`,\r\n    (value: string) => Number(value.replace(/\\s/g, \"\")) >= (min || 0)\r\n  ),\r\n});\r\n","import { ReactiveVariable } from \"vue/macros\";\r\nimport {\r\n  FormFieldNumberProps,\r\n  FormFieldProps,\r\n  FormFieldSelectProps,\r\n} from \"@/views/components/form/types\";\r\nimport { ValueTextType } from \"@/kernel/entities/types\";\r\nimport { reactive } from \"vue\";\r\nimport { requiredRules } from \"@/kernel/validation/vuelidate/requiredRules\";\r\nimport { minNumberRules } from \"@/kernel/validation/vuelidate/minNumberRules\";\r\nimport { maxLengthRules } from \"@/kernel/validation/vuelidate/maxLengthRules\";\r\n\r\ntype RequestFormCommonParamsFields = {\r\n  partner: FormFieldSelectProps<ValueTextType>;\r\n  point: FormFieldSelectProps<ValueTextType>;\r\n  statusSelect: FormFieldSelectProps<ValueTextType>;\r\n  subject: FormFieldSelectProps<ValueTextType>;\r\n  weight: FormFieldNumberProps;\r\n};\r\n\r\ntype RequestFormBaseParamsFields = {\r\n  base_price: FormFieldNumberProps;\r\n  base_dry_matter: FormFieldNumberProps;\r\n  base_price_with_tax: FormFieldNumberProps;\r\n  protein_rate: FormFieldNumberProps;\r\n  formula: FormFieldSelectProps<ValueTextType>;\r\n  fat_rate: FormFieldNumberProps;\r\n  base_protein: FormFieldNumberProps;\r\n  protein_correction: FormFieldNumberProps;\r\n  base_fat: FormFieldNumberProps;\r\n  fat_correction: FormFieldNumberProps;\r\n  max_fat: FormFieldNumberProps;\r\n};\r\n\r\ntype RequestFormSortParamsFields = {\r\n  ultra: FormFieldNumberProps;\r\n  second: FormFieldNumberProps;\r\n  extra: FormFieldNumberProps;\r\n  not_sorted: FormFieldNumberProps;\r\n  first: FormFieldNumberProps;\r\n};\r\n\r\ntype RequestFormCalculateParamsFields = {\r\n  payoff_base: FormFieldSelectProps<ValueTextType>;\r\n  payoff_vat: FormFieldSelectProps<ValueTextType>;\r\n  payoff_tariff: FormFieldNumberProps;\r\n  payoff_tariff_with_vat: FormFieldNumberProps;\r\n};\r\n\r\ntype RequestFormOtherParamsFields = {\r\n  other_price: FormFieldNumberProps;\r\n  comment: FormFieldProps;\r\n};\r\n\r\nexport type RequestFormFields = {\r\n  commonParams: RequestFormCommonParamsFields;\r\n  baseParams: RequestFormBaseParamsFields;\r\n  sortParams: RequestFormSortParamsFields;\r\n  calculateParams: RequestFormCalculateParamsFields;\r\n  other: RequestFormOtherParamsFields;\r\n};\r\n\r\nexport const useFields = () => {\r\n  const commonParams: RequestFormCommonParamsFields = {\r\n    partner: {\r\n      value: null,\r\n      id: \"partner_id\",\r\n      label: \"Покупатель\",\r\n      items: [],\r\n      rules: requiredRules(),\r\n      placeholder: \"\",\r\n    },\r\n    point: {\r\n      value: null,\r\n      id: \"point_id\",\r\n      label: \"Пункт\",\r\n      items: [],\r\n      rules: requiredRules(),\r\n      placeholder: \"\",\r\n      available: true,\r\n    },\r\n    subject: {\r\n      value: null,\r\n      id: \"subject\",\r\n      label: \"Предмет\",\r\n      items: [],\r\n      rules: requiredRules(),\r\n      placeholder: \"\",\r\n      available: false,\r\n    },\r\n    statusSelect: {\r\n      value: null,\r\n      id: \"status\",\r\n      label: \"Статус\",\r\n      items: [],\r\n      rules: requiredRules(),\r\n      placeholder: \"Выберите статус\",\r\n      available: true,\r\n    },\r\n    weight: {\r\n      id: \"weight\",\r\n      label: \"Вес\",\r\n      value: \"\",\r\n      unit: \"кг\",\r\n      step: 1000,\r\n      min: 0,\r\n      max: 100000,\r\n      afterDot: 0,\r\n      rules: {\r\n        ...requiredRules(),\r\n        ...minNumberRules(1),\r\n      },\r\n      available: true,\r\n    },\r\n  };\r\n  const baseParams: RequestFormBaseParamsFields = {\r\n    base_price: {\r\n      id: \"base_price\",\r\n      label: \"Базовая цена (без НДС)\",\r\n      unit: \"₽/кг\",\r\n      value: \"\",\r\n      hidden: \"\",\r\n      afterDot: 2,\r\n      step: 0.5,\r\n      min: 0,\r\n      max: 50,\r\n      rules: requiredRules(),\r\n      available: true,\r\n    },\r\n    base_dry_matter: {\r\n      id: \"base_dry_matter\",\r\n      label: \"Базовые сухие вещества\",\r\n      unit: \"%\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    base_price_with_tax: {\r\n      id: \"base_price_with_tax\",\r\n      label: \"Базовая цена (с НДС)\",\r\n      unit: \"₽/кг\",\r\n      value: \"\",\r\n      afterDot: 2,\r\n      step: 0.5,\r\n      min: 0,\r\n      max: 55,\r\n      available: true,\r\n    },\r\n    protein_rate: {\r\n      id: \"protein_rate\",\r\n      label: \"Доля показателя белка\",\r\n      unit: \"%\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    formula: {\r\n      value: null,\r\n      id: \"formula\",\r\n      label: \"Тип формулы рассчета\",\r\n      items: [],\r\n      rules: requiredRules(),\r\n      placeholder: \"\",\r\n      available: true,\r\n    },\r\n    fat_rate: {\r\n      id: \"fat_rate\",\r\n      label: \"Доля показателя жира\",\r\n      unit: \"%\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    base_protein: {\r\n      id: \"base_protein\",\r\n      label: \"Базовый белок\",\r\n      unit: \"%\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    protein_correction: {\r\n      id: \"protein_correction\",\r\n      label: \"Поправка на белок\",\r\n      unit: \"коп\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    base_fat: {\r\n      id: \"base_fat\",\r\n      label: \"Базовый жир\",\r\n      unit: \"%\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    fat_correction: {\r\n      id: \"fat_correction\",\r\n      label: \"Поправки на жир\",\r\n      unit: \"коп\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n    max_fat: {\r\n      id: \"max_fat\",\r\n      label: \"Потолок жира\",\r\n      unit: \"%\",\r\n      value: \"\",\r\n      available: true,\r\n    },\r\n  };\r\n  const sortParams: RequestFormSortParamsFields = {\r\n    ultra: {\r\n      id: \"class_ultra\",\r\n      label: \"Ультра\",\r\n      value: \"1.000\",\r\n      afterDot: 3,\r\n      step: 0.1,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n    second: {\r\n      id: \"class_second\",\r\n      label: \"2-ой сорт\",\r\n      value: \"1.000\",\r\n      afterDot: 3,\r\n      step: 0.1,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n    extra: {\r\n      id: \"class_extra\",\r\n      label: \"Высший\",\r\n      value: \"1.000\",\r\n      afterDot: 3,\r\n      step: 0.1,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n    not_sorted: {\r\n      id: \"class_not_sorted\",\r\n      label: \"Несортовое\",\r\n      value: \"1.000\",\r\n      afterDot: 3,\r\n      step: 0.1,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n    first: {\r\n      id: \"class_first\",\r\n      label: \"1-ый сорт\",\r\n      value: \"1.000\",\r\n      afterDot: 3,\r\n      step: 0.1,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n  };\r\n  const calculateParams: RequestFormCalculateParamsFields = {\r\n    payoff_base: {\r\n      value: null,\r\n      id: \"payoff_base\",\r\n      label: \"База компенсации\",\r\n      items: [],\r\n      rules: requiredRules(),\r\n      placeholder: \"Выберите базу компенсации\",\r\n      available: true,\r\n    },\r\n    payoff_vat: {\r\n      id: \"payoff_vat\",\r\n      label: \"Ставка НДС в тарифе\",\r\n      available: true,\r\n      items: [\r\n        {\r\n          value: \"10\",\r\n          text: \"10%\",\r\n        },\r\n        {\r\n          value: \"20\",\r\n          text: \"20%\",\r\n        },\r\n      ],\r\n      value: null,\r\n      rules: requiredRules(),\r\n      unit: \"%\",\r\n    },\r\n    payoff_tariff: {\r\n      id: \"payoff_tariff\",\r\n      label: \"Тариф (без НДС)\",\r\n      unit: \"₽\",\r\n      value: \"\",\r\n      afterDot: 2,\r\n      step: 0.5,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n    payoff_tariff_with_vat: {\r\n      id: \"payoff_tariff_with_vat\",\r\n      label: \"Тариф (с НДС)\",\r\n      unit: \"₽\",\r\n      value: \"\",\r\n      afterDot: 2,\r\n      step: 0.5,\r\n      available: true,\r\n      rules: requiredRules(),\r\n    },\r\n  };\r\n\r\n  const fields: ReactiveVariable<RequestFormFields> = reactive({\r\n    commonParams,\r\n    baseParams,\r\n    sortParams,\r\n    other: {\r\n      other_price: {\r\n        id: \"other_price\",\r\n        label: \"Прочие расходы\",\r\n        unit: \"₽/кг\",\r\n        value: \"\",\r\n        afterDot: 2,\r\n        step: 0.1,\r\n        min: 0,\r\n        max: 10,\r\n        available: true,\r\n      },\r\n      comment: {\r\n        id: \"comment\",\r\n        label: \"Комментарий\",\r\n        value: \"\",\r\n        rules: maxLengthRules(),\r\n      },\r\n    },\r\n    calculateParams,\r\n  });\r\n\r\n  return {\r\n    fields,\r\n  };\r\n};\r\n","import { RequestAddData } from \"@/kernel/api/dto/Request\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\n\r\nexport const usePrepareData = (fields: ReactiveVariable<RequestFormFields>) => {\r\n  function prepareData(): RequestAddData | null {\r\n    if (\r\n      !fields.commonParams.partner.value ||\r\n      !fields.commonParams.subject.value ||\r\n      !fields.commonParams.statusSelect.value ||\r\n      !fields.baseParams.formula.value ||\r\n      !fields.baseParams.base_price.hidden\r\n    ) {\r\n      return null;\r\n    }\r\n\r\n    const res: Record<string, any> = {\r\n      partner_id: Number(fields.commonParams.partner.value?.value),\r\n      status: fields.commonParams.statusSelect.value?.value,\r\n      weight: Number(fields.commonParams.weight.value.replace(/\\s/g, \"\")),\r\n      base_price: Number(fields.baseParams.base_price.hidden),\r\n      other_price: Number(fields.other.other_price.value),\r\n      payoff: fields.calculateParams.payoff_base.value ? 1 : 0,\r\n      class_rate: {\r\n        ultra: Number(fields.sortParams.ultra.value),\r\n        extra: Number(fields.sortParams.extra.value),\r\n        first: Number(fields.sortParams.first.value),\r\n        second: Number(fields.sortParams.second.value),\r\n        not_sorted: Number(fields.sortParams.not_sorted.value),\r\n      },\r\n      payoff_param: {\r\n        base: fields.calculateParams.payoff_base.value?.value || \"\",\r\n        tarif: Number(fields.calculateParams.payoff_tariff.value),\r\n        vat_rate: Number(fields.calculateParams.payoff_vat.value?.value),\r\n      },\r\n      param: {\r\n        subject: fields.commonParams.subject.value.value,\r\n        formula: fields.baseParams.formula.value?.value,\r\n      },\r\n    };\r\n\r\n    if (fields.other.comment.value) {\r\n      res.comment = fields.other.comment.value;\r\n    }\r\n\r\n    Object.entries(fields.baseParams)\r\n      .filter(\r\n        ([key, value]) =>\r\n          value.available &&\r\n          key !== \"formula\" &&\r\n          key !== \"base_price\" &&\r\n          key !== \"base_price_with_tax\"\r\n      )\r\n      .forEach(([key, value]) => {\r\n        res.param[key] = value.value;\r\n      });\r\n\r\n    if (fields.commonParams.point.value) {\r\n      res.point_id = Number(fields.commonParams.point.value.value);\r\n    }\r\n\r\n    return res as RequestAddData;\r\n  }\r\n\r\n  return {\r\n    prepareData,\r\n  };\r\n};\r\n","import { RequestAddData } from \"@/kernel/api/dto/Request\";\r\nimport { AvailableModalsEnum } from \"@/store/modal/types\";\r\nimport { postRequestAdd, postRequestEdit } from \"@/kernel/api/methods/Request\";\r\nimport { useStoreModal } from \"@/store/modal\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { usePrepareData } from \"@/views/modules/CrudForms/LacRequestForm/use/usePrepareData\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\n\r\nexport const useSubmit = (fields: ReactiveVariable<RequestFormFields>) => {\r\n  const modals = useStoreModal();\r\n  const router = useRouter();\r\n  const { prepareData } = usePrepareData(fields);\r\n\r\n  async function submit() {\r\n    const data = prepareData() as RequestAddData;\r\n\r\n    if (data) {\r\n      modals.open(AvailableModalsEnum.LOADER);\r\n      const res = await postRequestAdd(data);\r\n\r\n      if (!res.error) {\r\n        modals.open(AvailableModalsEnum.SUCCESS, {\r\n          callback: () => router.back(),\r\n        });\r\n      } else {\r\n        modals.open(AvailableModalsEnum.ERROR, {\r\n          text: res.data.info || \"Ошибка создания предложения\",\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  async function submitEdit(id: number) {\r\n    const data = prepareData();\r\n\r\n    if (data) {\r\n      modals.open(AvailableModalsEnum.LOADER);\r\n      const res = await postRequestEdit({ ...data, request_id: id });\r\n\r\n      if (!res.error) {\r\n        modals.open(AvailableModalsEnum.SUCCESS, {\r\n          callback: () => router.back(),\r\n        });\r\n      } else {\r\n        modals.open(AvailableModalsEnum.ERROR, {\r\n          text: res.data.info || \"Ошибка редактирования запроса\",\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    submit,\r\n    submitEdit,\r\n  };\r\n};\r\n","import { debounce } from \"@/kernel/lib/debounce\";\r\nimport { nextTick, ref } from \"vue\";\r\nimport { VAT } from \"@/kernel/constants/Vat\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { useStore } from \"@/store\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { numberPrettifyWithDigits } from \"@/kernel/lib/NumberFormat\";\r\n\r\nexport const useCalculate = (fields: ReactiveVariable<RequestFormFields>) => {\r\n  const { dictionary } = storeToRefs(useStore());\r\n  const recalculatePriceLock = ref(false);\r\n\r\n  function recalculateFatRate() {\r\n    if (\r\n      fields.commonParams.subject.value &&\r\n      fields.commonParams.subject.value.value === \"milk\" &&\r\n      fields.baseParams.formula.value &&\r\n      fields.baseParams.formula.value.value == \"standart\"\r\n    )\r\n      fields.baseParams.fat_rate.value = String(\r\n        100 - Number(fields.baseParams.protein_rate.value)\r\n      );\r\n  }\r\n\r\n  function recalculateBasePriceWithVat(init?: boolean) {\r\n    if (!recalculatePriceLock.value) {\r\n      recalculatePriceLock.value = true;\r\n\r\n      const basePrice = Number(fields.baseParams.base_price.value);\r\n      const basePriceHidden = Number(fields.baseParams.base_price.hidden);\r\n\r\n      if (init) {\r\n        // инициализируем.\r\n        fields.baseParams.base_price.hidden = basePrice.toFixed(4);\r\n        fields.baseParams.base_price.value = basePrice.toFixed(2);\r\n      } else {\r\n        if (basePriceHidden > (fields.baseParams.base_price.max || 0)) {\r\n          // ситуация когда срезали значение по max лимиту, а хидден не изменили.\r\n          fields.baseParams.base_price.hidden = basePrice.toFixed(4);\r\n        } else if (basePriceHidden < (fields.baseParams.base_price.min || 0)) {\r\n          // ситуация когда срезали значение по min лимиту, а хидден не изменили.\r\n          fields.baseParams.base_price.hidden = basePrice.toFixed(4);\r\n        }\r\n      }\r\n\r\n      fields.baseParams.base_price_with_tax.value = (\r\n        basePrice * ((dictionary.value.offer.vat_rate || VAT) / 100) +\r\n        basePrice\r\n      ).toFixed(2);\r\n\r\n      nextTick().then(() => {\r\n        recalculatePriceLock.value = false;\r\n      });\r\n    }\r\n  }\r\n\r\n  function recalculateBasePrice() {\r\n    if (!recalculatePriceLock.value) {\r\n      recalculatePriceLock.value = true;\r\n\r\n      const basePriceWithVat = Number(\r\n        fields.baseParams.base_price_with_tax.value\r\n      );\r\n      const hidden =\r\n        basePriceWithVat / (1 + (dictionary.value.offer.vat_rate || VAT) / 100);\r\n\r\n      fields.baseParams.base_price.hidden = hidden.toFixed(4);\r\n      fields.baseParams.base_price.value = hidden.toFixed(2);\r\n\r\n      nextTick().then(() => {\r\n        recalculatePriceLock.value = false;\r\n      });\r\n    }\r\n  }\r\n\r\n  const recalculatePayoffTariffLock = ref(false);\r\n  async function recalculatePayoffTariff() {\r\n    if (!recalculatePayoffTariffLock.value) {\r\n      recalculatePayoffTariffLock.value = true;\r\n\r\n      const vat = Number(fields.calculateParams.payoff_vat.value?.value);\r\n\r\n      if (!vat || isNaN(vat)) {\r\n        fields.calculateParams.payoff_tariff_with_vat.value =\r\n          numberPrettifyWithDigits(\r\n            fields.calculateParams.payoff_tariff.value,\r\n            fields.calculateParams.payoff_tariff_with_vat.afterDot\r\n          );\r\n      }\r\n\r\n      const tariff = Number(fields.calculateParams.payoff_tariff.value);\r\n      fields.calculateParams.payoff_tariff_with_vat.value =\r\n        numberPrettifyWithDigits(tariff * (vat / 100) + tariff, 2);\r\n\r\n      await nextTick();\r\n      recalculatePayoffTariffLock.value = false;\r\n    }\r\n  }\r\n  async function recalculatePayoffTariffWithTax() {\r\n    if (!recalculatePayoffTariffLock.value) {\r\n      recalculatePayoffTariffLock.value = true;\r\n\r\n      const vat = Number(fields.calculateParams.payoff_vat.value?.value);\r\n\r\n      if (!vat || isNaN(vat)) {\r\n        fields.calculateParams.payoff_tariff.value = numberPrettifyWithDigits(\r\n          fields.calculateParams.payoff_tariff_with_vat.value,\r\n          2\r\n        );\r\n      }\r\n\r\n      const tariff = Number(\r\n        fields.calculateParams.payoff_tariff_with_vat.value\r\n      );\r\n      fields.calculateParams.payoff_tariff.value = numberPrettifyWithDigits(\r\n        tariff / (1 + vat / 100),\r\n        2\r\n      );\r\n\r\n      await nextTick();\r\n      recalculatePayoffTariffLock.value = false;\r\n    }\r\n  }\r\n\r\n  return {\r\n    recalculateFatRate,\r\n    recalculateBasePrice,\r\n    recalculateBasePriceWithVat,\r\n    recalculatePayoffTariff,\r\n    recalculatePayoffTariffWithTax,\r\n  };\r\n};\r\n","import { ValueTextType } from \"@/kernel/entities/types\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { useStore } from \"@/store\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\n\r\nexport const useSetFormula = (fields: ReactiveVariable<RequestFormFields>) => {\r\n  const { dictionary } = storeToRefs(useStore());\r\n\r\n  function setFormula() {\r\n    const formula = dictionary.value.offer.formula;\r\n    const available_formula_by_subject =\r\n      dictionary.value.offer.available_formula_by_subject;\r\n\r\n    fields.baseParams.formula.items = Object.entries(formula)\r\n      .filter(([f, _]) =>\r\n        fields.commonParams.subject.value?.value\r\n          ? available_formula_by_subject[\r\n              fields.commonParams.subject.value.value\r\n            ].some((el) => el === f)\r\n          : false\r\n      )\r\n      .map(\r\n        ([key, value]): ValueTextType => ({\r\n          value: key,\r\n          text: value,\r\n        })\r\n      );\r\n\r\n    if (fields.commonParams.subject.value?.value === \"milk\") {\r\n      const foundStandard = fields.baseParams.formula.items.find(\r\n        (el) => el.value === \"standart\"\r\n      );\r\n      if (foundStandard) {\r\n        fields.baseParams.formula.value = foundStandard;\r\n      } else {\r\n        const foundPhysicalWeight = fields.baseParams.formula.items.find(\r\n          (el) => el.value === \"physical_weight\"\r\n        );\r\n        foundPhysicalWeight &&\r\n          (fields.baseParams.formula.value = foundPhysicalWeight);\r\n      }\r\n    } else {\r\n      const foundPhysicalWeight = fields.baseParams.formula.items.find(\r\n        (el) => el.value === \"physical_weight\"\r\n      );\r\n      foundPhysicalWeight &&\r\n        (fields.baseParams.formula.value = foundPhysicalWeight);\r\n    }\r\n  }\r\n\r\n  return {\r\n    setFormula,\r\n  };\r\n};\r\n","import { ReactiveVariable } from \"vue/macros\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { useStore } from \"@/store\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\n\r\nexport const useInitialParams = (\r\n  fields: ReactiveVariable<RequestFormFields>\r\n) => {\r\n  const { dictionary } = storeToRefs(useStore());\r\n\r\n  function initialParams(): void {\r\n    const properties = dictionary.value.offer.property;\r\n\r\n    const fieldsNames = [\r\n      \"protein_rate\",\r\n      \"base_dry_matter\",\r\n      \"base_fat\",\r\n      \"base_protein\",\r\n      \"fat_correction\",\r\n      \"fat_rate\",\r\n      \"max_fat\",\r\n      \"protein_correction\",\r\n      \"protein_rate\",\r\n    ];\r\n\r\n    fieldsNames.forEach((name: string) => {\r\n      //@ts-ignore\r\n      if (fields.baseParams[name]) {\r\n        //@ts-ignore\r\n        fields.baseParams[name].available = false;\r\n      }\r\n    });\r\n\r\n    const processParams = (fieldset: string) => {\r\n      const formula = fields.baseParams.formula.value?.value || \"\";\r\n      const subject = fields.commonParams.subject.value?.value || \"\";\r\n      // @ts-ignore\r\n      const fieldsetObject = fields[fieldset];\r\n      const propertiesArray = Object.entries(properties);\r\n      if (fieldsetObject) {\r\n        const excludedFields = Object.entries(fieldsetObject).filter(\r\n          ([key, value]) => propertiesArray.some(([k, val]) => k === key)\r\n        );\r\n        excludedFields.forEach(([key, value]) => {\r\n          // @ts-ignore\r\n          value.value = \"\";\r\n        });\r\n      }\r\n\r\n      propertiesArray.forEach(([key, value]) => {\r\n        // @ts-ignore\r\n        const field = fields[fieldset][key];\r\n        const params = value.cond[formula]?.[subject];\r\n        if (field && params) {\r\n          typeof params.max === \"number\"\r\n            ? (field.max = params.max)\r\n            : delete field.max;\r\n\r\n          if (typeof params.min === \"number\") {\r\n            field.min = params.min;\r\n          } else {\r\n            delete field.min;\r\n          }\r\n\r\n          if (typeof params.fix === \"number\") {\r\n            field.min = params.fix;\r\n            field.max = params.fix;\r\n            field.fix = params.fix;\r\n          } else {\r\n            delete field.fix;\r\n          }\r\n          typeof params.after_dot === \"number\"\r\n            ? (field.afterDot = params.after_dot)\r\n            : delete field.afterDot;\r\n          typeof params.step === \"number\"\r\n            ? (field.step = params.step)\r\n            : delete field.step;\r\n\r\n          field.available = true;\r\n\r\n          if (params.def !== undefined) {\r\n            field.value =\r\n              typeof field.afterDot === \"number\"\r\n                ? params.def.toFixed(field.afterDot)\r\n                : String(params.def);\r\n          } else {\r\n            field.value =\r\n              typeof params.fix === \"number\"\r\n                ? typeof field.afterDot === \"number\"\r\n                  ? params.fix.toFixed(field.afterDot)\r\n                  : String(params.fix)\r\n                : \"\";\r\n          }\r\n\r\n          // @ts-ignore\r\n          fields[fieldset][key] = field;\r\n        }\r\n      });\r\n    };\r\n\r\n    processParams(\"baseParams\");\r\n\r\n    if (\r\n      Number(fields.baseParams.protein_rate.value) +\r\n        Number(fields.baseParams.fat_rate.value) >\r\n      100\r\n    ) {\r\n      fields.baseParams.fat_rate.value = String(\r\n        100 - Number(fields.baseParams.protein_rate.value)\r\n      );\r\n    }\r\n  }\r\n\r\n  return {\r\n    initialParams,\r\n  };\r\n};\r\n","import { ReactiveVariable } from \"vue/macros\";\r\nimport { Ref } from \"vue\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { RequestGetData } from \"@/kernel/api/dto/Request\";\r\nimport { useStorePoint } from \"@/store/point\";\r\nimport { PointEntity } from \"@/kernel/entities/Point\";\r\n\r\nexport const useUpdatePoints = (\r\n  fields: ReactiveVariable<RequestFormFields>,\r\n  isInit: Ref<boolean>,\r\n  requestData: Ref<RequestGetData | null>\r\n) => {\r\n  const storePoint = useStorePoint();\r\n\r\n  async function updatePoints() {\r\n    fields.commonParams.point.value = null;\r\n\r\n    const partner_id: number = parseInt(\r\n      fields.commonParams.partner.value?.value || \"0\"\r\n    );\r\n    // вдруг стор по пунктам не наполнен.\r\n    await storePoint.getAllPoints();\r\n    const points: PointEntity[] =\r\n      storePoint.getPoints({ partner_id: partner_id, noStore: true }) || [];\r\n\r\n    fields.commonParams.point.items =\r\n      points\r\n        .filter((p) => p.subject_to_buy.length)\r\n        .map((p) => ({\r\n          value: String(p.point_id),\r\n          text: p.name,\r\n        })) || [];\r\n\r\n    fields.commonParams.point.available =\r\n      !!fields.commonParams.point.items.length;\r\n\r\n    if (fields.commonParams.point.items.length === 1) {\r\n      fields.commonParams.point.value = fields.commonParams.point.items[0];\r\n    }\r\n\r\n    if (!isInit.value && requestData.value) {\r\n      const found = fields.commonParams.point.items.find(\r\n        (el) => el.value === String(requestData.value!.point.point_id)\r\n      );\r\n      found && (fields.commonParams.point.value = found);\r\n    }\r\n  }\r\n\r\n  return {\r\n    updatePoints,\r\n  };\r\n};\r\n","import { nextTick, Ref } from \"vue\";\r\nimport { ValueTextType } from \"@/kernel/entities/types\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { useUpdate } from \"@/views/modules/CrudForms/use/useUpdate\";\r\nimport { useStore } from \"@/store\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { useStorePartner } from \"@/store/partner\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\nimport { useSetFormula } from \"@/views/modules/CrudForms/LacRequestForm/use/useSetFormula\";\r\nimport { useInitialParams } from \"@/views/modules/CrudForms/LacRequestForm/use/useInitialParams\";\r\nimport { useUpdatePoints } from \"@/views/modules/CrudForms/LacRequestForm/use/useUpdatePoints\";\r\nimport { RequestGetData } from \"@/kernel/api/dto/Request\";\r\nimport { AvailableModalsEnum } from \"@/store/modal/types\";\r\nimport { useStoreModal } from \"@/store/modal\";\r\n\r\nexport const useInit = (\r\n  fields: ReactiveVariable<RequestFormFields>,\r\n  isInit: Ref<boolean>,\r\n  requestData: Ref<RequestGetData | null>,\r\n  setWatchers: () => void\r\n) => {\r\n  const modals = useStoreModal();\r\n  const { dictionary } = storeToRefs(useStore());\r\n  const storePartner = useStorePartner();\r\n  const { selectPartnerId, partners } = storeToRefs(storePartner);\r\n  const { setFormula } = useSetFormula(fields);\r\n  const { updatePoints } = useUpdatePoints(fields, isInit, requestData);\r\n  const { initialParams } = useInitialParams(fields);\r\n  const {\r\n    updatePartner,\r\n    updatePoint,\r\n    updateSubject,\r\n    updateFormula,\r\n    updateStatus,\r\n  } = useUpdate(isInit);\r\n\r\n  async function initPartner() {\r\n    let edit, partnerId, pointId, subject, formula, status;\r\n    if (requestData.value) {\r\n      edit = true;\r\n      partnerId = requestData.value.partner.partner_id;\r\n      pointId = requestData.value.point.point_id;\r\n      subject = requestData.value.subject;\r\n      formula = requestData.value.formula;\r\n      status = requestData.value.status;\r\n    }\r\n    await updatePartner(fields.commonParams.partner, partnerId);\r\n    if (!edit && fields.commonParams.partner.value) {\r\n      partnerId = parseInt(fields.commonParams.partner.value.value);\r\n    }\r\n    await updatePoint(fields.commonParams.point, \"request\", partnerId, pointId);\r\n    if (!edit && fields.commonParams.point.value) {\r\n      pointId = parseInt(fields.commonParams.point.value.value);\r\n    }\r\n    await updateSubject(\r\n      fields.commonParams.subject,\r\n      \"request\",\r\n      pointId,\r\n      subject\r\n    );\r\n    const subjValue = fields.commonParams.subject.value\r\n      ? fields.commonParams.subject.value.value\r\n      : undefined;\r\n    await updateFormula(fields.baseParams.formula, subjValue, formula);\r\n    await updateStatus(fields.commonParams.statusSelect, \"request\", status);\r\n    if (fields.commonParams.subject.value) initialParams();\r\n  }\r\n\r\n  async function initSelects() {\r\n    await initPartner();\r\n\r\n    fields.calculateParams.payoff_base.items.push(\r\n      ...Object.entries(dictionary.value.request.payoff_base).map(\r\n        ([key, value]: [\r\n          string,\r\n          { desc: string; vat: number }\r\n        ]): ValueTextType => ({\r\n          value: key,\r\n          text: value.desc,\r\n        })\r\n      )\r\n    );\r\n    const foundPayoff = fields.calculateParams.payoff_base.items.find(\r\n      (el) => el.value === \"rub_per_kg\"\r\n    );\r\n    if (foundPayoff) {\r\n      fields.calculateParams.payoff_base.value = foundPayoff;\r\n    }\r\n\r\n    fields.calculateParams.payoff_vat.value =\r\n      fields.calculateParams.payoff_vat.items.find((el) => el.value === \"20\") ||\r\n      null;\r\n\r\n    // setFormula();\r\n  }\r\n\r\n  async function init() {\r\n    modals.open(AvailableModalsEnum.LOADER);\r\n\r\n    await initSelects();\r\n    isInit.value = true;\r\n\r\n    await nextTick();\r\n    setWatchers();\r\n    modals.close();\r\n  }\r\n\r\n  return {\r\n    init,\r\n  };\r\n};\r\n","import { nextTick, ref, watch } from \"vue\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport {\r\n  LacSelectOption,\r\n  FormFieldSelectProps,\r\n} from \"@/views/components/form/types\";\r\n\r\ntype CallbacksCollection = {\r\n  updateSubject: (\r\n    path: ReactiveVariable<FormFieldSelectProps>,\r\n    type: string,\r\n    pointId?: number,\r\n    subject?: number\r\n  ) => Promise<void>;\r\n  updatePoint: (\r\n    path: ReactiveVariable<FormFieldSelectProps>,\r\n    type: \"offer\" | \"request\",\r\n    partnerId: number | undefined,\r\n    pointId?: number\r\n  ) => Promise<void>;\r\n  updateFormula: (\r\n    path: ReactiveVariable<FormFieldSelectProps>,\r\n    subject: string | undefined,\r\n    formula?: string | undefined\r\n  ) => Promise<void>;\r\n  initialParams: () => void;\r\n  recalculateFatRate: () => void;\r\n  recalculateBasePrice: () => void;\r\n  recalculateBasePriceWithVat: () => void;\r\n  recalculatePayoffTariff: () => void;\r\n  recalculatePayoffTariffWithTax: () => void;\r\n};\r\n\r\nexport const useWatch = (\r\n  fields: ReactiveVariable<RequestFormFields>,\r\n  callbacks: CallbacksCollection\r\n) => {\r\n  const watchLock = ref(false);\r\n  const {\r\n    updateSubject,\r\n    updatePoint,\r\n    updateFormula,\r\n    initialParams,\r\n    recalculateBasePrice,\r\n    recalculateBasePriceWithVat,\r\n    recalculateFatRate,\r\n    recalculatePayoffTariff,\r\n    recalculatePayoffTariffWithTax,\r\n  } = callbacks;\r\n\r\n  function setWatchers() {\r\n    watch(\r\n      () => fields.commonParams.partner.value?.value,\r\n      async (newValue) => {\r\n        if (watchLock.value) return;\r\n\r\n        const partnerId = newValue ? parseInt(newValue) : undefined;\r\n        await updatePoint(fields.commonParams.point, \"request\", partnerId);\r\n      }\r\n    );\r\n\r\n    watch(\r\n      () => fields.commonParams.point.value?.value,\r\n      async (newValue) => {\r\n        if (watchLock.value) return;\r\n\r\n        const pointId = newValue ? parseInt(newValue) : undefined;\r\n        await updateSubject(fields.commonParams.subject, \"request\", pointId);\r\n      }\r\n    );\r\n    watch(\r\n      () => fields.commonParams.subject.value,\r\n      async () => {\r\n        if (watchLock.value) return;\r\n\r\n        const subjValue = fields.commonParams.subject.value\r\n          ? fields.commonParams.subject.value.value\r\n          : undefined;\r\n        await updateFormula(fields.baseParams.formula, subjValue);\r\n        initialParams();\r\n      }\r\n    );\r\n    watch(\r\n      () => fields.baseParams.formula.value,\r\n      () => {\r\n        if (watchLock.value) return;\r\n\r\n        initialParams();\r\n      }\r\n    );\r\n    watch(\r\n      () => fields.baseParams.protein_rate.value,\r\n      () => {\r\n        if (watchLock.value) return;\r\n        recalculateFatRate();\r\n      }\r\n    );\r\n    watch(\r\n      () => [\r\n        fields.baseParams.base_price.value,\r\n        fields.baseParams.base_price.hidden,\r\n      ],\r\n      ([, newHid], [, prevHid]) => {\r\n        if (watchLock.value) return;\r\n        if (newHid !== prevHid) recalculateBasePriceWithVat();\r\n      }\r\n    );\r\n    watch(\r\n      () => fields.baseParams.base_price_with_tax.value,\r\n      () => {\r\n        if (watchLock.value) return;\r\n\r\n        recalculateBasePrice();\r\n      }\r\n    );\r\n    watch(\r\n      () => [\r\n        fields.calculateParams.payoff_vat.value,\r\n        fields.calculateParams.payoff_tariff.value,\r\n      ],\r\n      async () => {\r\n        if (watchLock.value) return;\r\n\r\n        await recalculatePayoffTariff();\r\n      }\r\n    );\r\n    watch(\r\n      () => fields.calculateParams.payoff_tariff_with_vat.value,\r\n      async () => {\r\n        if (watchLock.value) return;\r\n\r\n        await recalculatePayoffTariffWithTax();\r\n      }\r\n    );\r\n  }\r\n\r\n  return {\r\n    setWatchers,\r\n    lockWatchers: () => (watchLock.value = true),\r\n    unlockWatchers: () => (watchLock.value = false),\r\n  };\r\n};\r\n","import { nextTick, Ref } from \"vue\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\nimport { RequestFormFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { RequestGetData } from \"@/kernel/api/dto/Request\";\r\nimport { useUpdatePoints } from \"@/views/modules/CrudForms/LacRequestForm/use/useUpdatePoints\";\r\nimport { useSetFormula } from \"@/views/modules/CrudForms/LacRequestForm/use/useSetFormula\";\r\nimport { useInitialParams } from \"@/views/modules/CrudForms/LacRequestForm/use/useInitialParams\";\r\nimport { useCalculate } from \"@/views/modules/CrudForms/LacRequestForm/use/useCalculate\";\r\nimport { numberPrettifyWithDigits } from \"@/kernel/lib/NumberFormat\";\r\n\r\nexport const useFillForm = (\r\n  fields: ReactiveVariable<RequestFormFields>,\r\n  requestData: Ref<RequestGetData | null>,\r\n  isInit: Ref<boolean>,\r\n  lockWatchers: () => void,\r\n  unlockWatchers: () => void\r\n) => {\r\n  const { updatePoints } = useUpdatePoints(fields, isInit, requestData);\r\n  const { setFormula } = useSetFormula(fields);\r\n  const { initialParams } = useInitialParams(fields);\r\n  const { recalculateBasePriceWithVat, recalculatePayoffTariff } =\r\n    useCalculate(fields);\r\n\r\n  async function fillForm(): Promise<void> {\r\n    if (!requestData.value) return;\r\n\r\n    isInit.value = false;\r\n    lockWatchers();\r\n\r\n    // const subject = fields.commonParams.subject.items.find(\r\n    //   (el) => el.val === requestData.value!.subject\r\n    // );\r\n\r\n    // if (subject) {\r\n    //   fields.commonParams.subject.value = subject;\r\n    //   setFormula();\r\n    // }\r\n\r\n    // const formula = fields.baseParams.formula.items.find(\r\n    //   (el) => el.value === requestData.value!.formula\r\n    // );\r\n    // formula && (fields.baseParams.formula.value = formula);\r\n\r\n    fields.commonParams.weight.value = numberPrettifyWithDigits(\r\n      requestData.value!.weight\r\n    );\r\n\r\n    fields.baseParams.base_price.value = String(requestData.value!.base_price);\r\n    recalculateBasePriceWithVat(true);\r\n\r\n    Object.entries(fields.sortParams).map(([sort, obj]) => {\r\n      const found = requestData.value?.class_rate[sort];\r\n      if (found) {\r\n        obj.value = found.toFixed(3);\r\n      }\r\n    });\r\n\r\n    requestData.value?.other_price &&\r\n      (fields.other.other_price.value = String(requestData.value!.other_price));\r\n\r\n    const params = requestData.value?.param;\r\n    if (params) {\r\n      params.base_protein &&\r\n        (fields.baseParams.base_protein.value = String(params.base_protein));\r\n      params.base_fat &&\r\n        (fields.baseParams.base_fat.value = String(params.base_fat));\r\n      params.protein_rate &&\r\n        (fields.baseParams.protein_rate.value = String(params.protein_rate));\r\n      params.fat_rate &&\r\n        (fields.baseParams.fat_rate.value = String(params.fat_rate));\r\n      params.max_fat &&\r\n        (fields.baseParams.max_fat.value = String(params.max_fat));\r\n    }\r\n\r\n    if (requestData.value?.payoff && requestData.value?.payoff_param) {\r\n      const baseFound = fields.calculateParams.payoff_base.items.find(\r\n        (base) => base.value === requestData.value!.payoff_param.base\r\n      );\r\n      baseFound && (fields.calculateParams.payoff_base.value = baseFound);\r\n      const foundVat = fields.calculateParams.payoff_vat.items.find(\r\n        (el) => el.value === String(requestData.value?.payoff_param.vat_rate)\r\n      );\r\n      if (foundVat) {\r\n        fields.calculateParams.payoff_vat.value = foundVat;\r\n      }\r\n\r\n      fields.calculateParams.payoff_tariff.value = numberPrettifyWithDigits(\r\n        requestData.value?.payoff_param.tarif,\r\n        fields.calculateParams.payoff_tariff.afterDot\r\n      );\r\n\r\n      await recalculatePayoffTariff();\r\n    }\r\n\r\n    requestData.value?.comment &&\r\n      (fields.other.comment.value = requestData.value?.comment);\r\n\r\n    await nextTick();\r\n    isInit.value = true;\r\n    unlockWatchers();\r\n  }\r\n\r\n  return {\r\n    fillForm,\r\n  };\r\n};\r\n","import { getRequestGet } from \"@/kernel/api/methods/Request\";\r\nimport { ref, Ref } from \"vue\";\r\nimport { RequestGetData } from \"@/kernel/api/dto/Request\";\r\n\r\nexport const useData = () => {\r\n  const requestData: Ref<RequestGetData | null> = ref(null);\r\n\r\n  async function fetchData(id: number) {\r\n    const res = await getRequestGet(id);\r\n\r\n    if (!res.error && res.data.info) {\r\n      requestData.value = res.data.info;\r\n    }\r\n  }\r\n\r\n  return {\r\n    fetchData,\r\n    requestData,\r\n  };\r\n};\r\n","import { useFormValidate } from \"@/use/useFormValidate\";\r\nimport { ref } from \"vue\";\r\nimport { useFields } from \"@/views/modules/CrudForms/LacRequestForm/use/useFields\";\r\nimport { useSubmit } from \"@/views/modules/CrudForms/LacRequestForm/use/useSubmit\";\r\nimport { useCalculate } from \"@/views/modules/CrudForms/LacRequestForm/use/useCalculate\";\r\nimport { useSetFormula } from \"@/views/modules/CrudForms/LacRequestForm/use/useSetFormula\";\r\nimport { useUpdate } from \"@/views/modules/CrudForms/use/useUpdate\";\r\nimport { useInit } from \"@/views/modules/CrudForms/LacRequestForm/use/useInit\";\r\nimport { useWatch } from \"@/views/modules/CrudForms/LacRequestForm/use/useWatch\";\r\nimport { useInitialParams } from \"@/views/modules/CrudForms/LacRequestForm/use/useInitialParams\";\r\nimport { useFillForm } from \"@/views/modules/CrudForms/LacRequestForm/use/useFillForm\";\r\nimport { useData } from \"@/views/modules/CrudForms/LacRequestForm/use/useData\";\r\n\r\nexport const useRequestForm = () => {\r\n  const { setFieldRef, validateForm, resetValidations } = useFormValidate();\r\n  const isInit = ref(false);\r\n  const isChanged = ref(true);\r\n\r\n  const { fields } = useFields();\r\n  const { requestData, fetchData } = useData();\r\n  const { submit, submitEdit } = useSubmit(fields);\r\n  const { setFormula } = useSetFormula(fields);\r\n  const { updatePoint, updateSubject, updateFormula, updateStatus } =\r\n    useUpdate(isInit);\r\n  const { initialParams } = useInitialParams(fields);\r\n\r\n  const {\r\n    recalculateFatRate,\r\n    recalculateBasePriceWithVat,\r\n    recalculatePayoffTariff,\r\n    recalculatePayoffTariffWithTax,\r\n    recalculateBasePrice,\r\n  } = useCalculate(fields);\r\n\r\n  const { setWatchers, lockWatchers, unlockWatchers } = useWatch(fields, {\r\n    recalculateFatRate,\r\n    recalculateBasePriceWithVat,\r\n    recalculateBasePrice,\r\n    recalculatePayoffTariffWithTax,\r\n    recalculatePayoffTariff,\r\n    updateSubject,\r\n    updatePoint,\r\n    updateFormula,\r\n    initialParams,\r\n  });\r\n\r\n  const { init } = useInit(fields, isInit, requestData, setWatchers);\r\n  const { fillForm } = useFillForm(\r\n    fields,\r\n    requestData,\r\n    isInit,\r\n    lockWatchers,\r\n    unlockWatchers\r\n  );\r\n\r\n  return {\r\n    fields,\r\n    setFieldRef,\r\n    validateForm,\r\n    resetValidations,\r\n    init,\r\n    fetchData,\r\n    fillForm,\r\n    isInit,\r\n    submit,\r\n    submitEdit,\r\n    isChanged,\r\n  };\r\n};\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"p-inputgroup flex-1\" }\nconst _hoisted_2 = {\n  class: \"p-inputgroup-addon\",\n  style: {\"background\":\"#fafafa\"}\n}\n\nimport LacLabel from \"@/views/components/ui/LacLabel.vue\";\r\nimport { computed, nextTick, onMounted, ref } from \"vue\";\r\nimport useVuelidate, { ValidationArgs } from \"@vuelidate/core\";\r\nimport formModule from \"@/views/components/form/form.module.scss\";\r\nimport { FormField } from \"@/views/components/form/types\";\r\nimport { numberPrettifyWithDigits } from \"@/kernel/lib/NumberFormat\";\r\nimport { useToast } from \"primevue/usetoast\";\r\n\r\ninterface Props {\r\n  label?: string;\r\n  placeholder?: string;\r\n  id: string;\r\n  value: string;\r\n  hidden?: string;\r\n  icon?: string;\r\n  rules?: ValidationArgs;\r\n  type?: string;\r\n  disabled?: boolean;\r\n  step?: number;\r\n  min?: number;\r\n  max?: number;\r\n  afterDot?: number;\r\n  suffix?: string;\r\n  localePrettify?: boolean;\r\n}\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'LacInputNumber',\n  props: {\n    label: {},\n    placeholder: {},\n    id: {},\n    value: {},\n    hidden: {},\n    icon: {},\n    rules: {},\n    type: {},\n    disabled: { type: Boolean },\n    step: { default: 1 },\n    min: {},\n    max: {},\n    afterDot: {},\n    suffix: {},\n    localePrettify: { type: Boolean }\n  },\n  emits: [\"update:value\", \"focus\", \"blur\"],\n  setup(__props: any, { expose: __expose, emit }) {\n\nconst props = __props;\n\r\nconst toast = useToast();\r\n\r\n\r\nconst isShow = ref(false);\r\n\r\nconst v$ = useVuelidate(\r\n  { props: { value: props.rules || {} } },\r\n  {\r\n    props,\r\n  }\r\n);\r\n\r\nconst validationError = computed(() =>\r\n  v$.value.$errors.length ? true : false\r\n);\r\n\r\n\r\n\r\nconst value = computed({\r\n  get(): string {\r\n    return props.value;\r\n  },\r\n  set(value: string) {\r\n    emit(\"update:value\", value.replace(\",\", \".\"));\r\n  },\r\n});\r\n\r\nasync function validate(): Promise<boolean> {\r\n  const isValid = await v$.value.$validate();\r\n  if (!isValid) {\r\n    toast.add({\r\n      severity: \"error\",\r\n      summary: props.label,\r\n      detail: v$.value.$errors[0].$message,\r\n    });\r\n  }\r\n  return isValid;\r\n}\r\n\r\nfunction validationReset(): void {\r\n  v$.value.$reset();\r\n}\r\n\r\nasync function onBlur(id: string) {\r\n  await nextTick();\r\n  window.removeEventListener(\"keyup\", onKeyDown);\r\n  if (id === \"base_price\") {\r\n    emit(\"blur\", value.value);\r\n  }\r\n  value.value = props.localePrettify\r\n    ? numberPrettifyWithDigits(clear(value.value), props.afterDot || 0)\r\n    : clear(value.value);\r\n}\r\nfunction onFocus(id: string) {\r\n  if (id === \"base_price\") {\r\n    emit(\"focus\");\r\n  }\r\n  window.addEventListener(\"keyup\", onKeyDown);\r\n}\r\n\r\nfunction clear(value: string): string {\r\n  let res = Number(String(value).replace(/\\s/g, \"\").replace(\",\", \".\"));\r\n\r\n  if (\r\n    typeof props.max === \"number\" &&\r\n    typeof props.min === \"number\" &&\r\n    props.max === props.min\r\n  ) {\r\n    res = props.max;\r\n  } else {\r\n    if (typeof props.max === \"number\" && res > props.max) {\r\n      res = props.max;\r\n    }\r\n\r\n    if (typeof props.min === \"number\" && res < props.min) {\r\n      res = props.min;\r\n    }\r\n  }\r\n\r\n  let result = Number.isNaN(res)\r\n    ? \"0\"\r\n    : typeof props.afterDot === \"number\"\r\n    ? res.toFixed(props.afterDot)\r\n    : String(res);\r\n\r\n  return result;\r\n}\r\n\r\nfunction onKeyDown(e: KeyboardEvent) {\r\n  if (e.keyCode === 38) {\r\n    onUp();\r\n    return;\r\n  }\r\n  if (e.keyCode === 40) {\r\n    onDown();\r\n    return;\r\n  }\r\n}\r\n\r\nfunction split(value: string) {\r\n  return value.replace(\",\", \".\").split(\".\");\r\n}\r\n\r\nfunction onUp() {\r\n  const val = clear(value.value);\r\n  const parsed = split(val);\r\n  const afterDot = props.afterDot || parsed[1] ? parsed[1].length : 0;\r\n  let div = \"1\";\r\n  for (let i = 0; i < afterDot; i++) {\r\n    div += \"0\";\r\n  }\r\n  const readyNumber = props.afterDot\r\n    ? Number(Number(val).toFixed(props.afterDot))\r\n    : Number(val);\r\n  let res =\r\n    (readyNumber * Number(div) + props.step * Number(div)) / Number(div);\r\n\r\n  if (props.max && res > props.max) {\r\n    res = props.max;\r\n  }\r\n\r\n  value.value = clear(String(res));\r\n}\r\nfunction onDown() {\r\n  const val = clear(value.value);\r\n  const parsed = split(val);\r\n  const afterDot = props.afterDot || parsed[1] ? parsed[1].length : 0;\r\n  let div = \"1\";\r\n  for (let i = 0; i < afterDot; i++) {\r\n    div += \"0\";\r\n  }\r\n  const readyNumber = props.afterDot\r\n    ? Number(Number(val).toFixed(props.afterDot))\r\n    : Number(val);\r\n  let res =\r\n    (readyNumber * Number(div) - props.step * Number(div)) / Number(div);\r\n\r\n  if (props.min && res < props.min) {\r\n    res = props.min;\r\n  }\r\n\r\n  value.value = clear(String(res));\r\n}\r\n\r\n__expose<FormField>({ validate, validationReset, id: props.id });\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_InputText = _resolveComponent(\"InputText\")!\n\n  return (_openBlock(), _createBlock(LacLabel, {\n    id: props.id,\n    label: props.label\n  }, {\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _createVNode(_component_InputText, {\n          modelValue: value.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((value).value = $event)),\n          id: props.id,\n          class: _normalizeClass(['w-100', { 'p-invalid': validationError.value }]),\n          placeholder: props.placeholder,\n          disabled: _ctx.disabled,\n          onFocus: _cache[1] || (_cache[1] = ($event: any) => (onFocus(props.id))),\n          onBlur: _cache[2] || (_cache[2] = ($event: any) => (onBlur(props.id)))\n        }, null, 8, [\"modelValue\", \"id\", \"class\", \"placeholder\", \"disabled\"]),\n        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(props.suffix), 1)\n      ])\n    ]),\n    _: 1\n  }, 8, [\"id\", \"label\"]))\n}\n}\n\n})","import script from \"./LacInputNumber.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./LacInputNumber.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["getRequestDelete","async","res","getHttp","get","searchParams","request_id","id","NotRequestException","name","getRequestGet","getRequestList","params","postRequestAdd","post","payload","param","JSON","stringify","class_rate","payoff_param","postRequestEdit","VAT","numberPrettifyWithDigits","value","digits","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","replaceAll","replace","minNumberRules","min","helpers","withMessage","Number","useFields","commonParams","partner","label","items","rules","requiredRules","placeholder","point","available","subject","statusSelect","weight","unit","step","max","afterDot","baseParams","base_price","hidden","base_dry_matter","base_price_with_tax","protein_rate","formula","fat_rate","base_protein","protein_correction","base_fat","fat_correction","max_fat","sortParams","ultra","second","extra","not_sorted","first","calculateParams","payoff_base","payoff_vat","text","payoff_tariff","payoff_tariff_with_vat","fields","reactive","other","other_price","comment","maxLengthRules","usePrepareData","prepareData","partner_id","status","payoff","base","tarif","vat_rate","Object","entries","filter","key","forEach","point_id","useSubmit","modals","useStoreModal","router","useRouter","submit","data","open","AvailableModalsEnum","LOADER","error","ERROR","info","SUCCESS","callback","back","submitEdit","useCalculate","dictionary","storeToRefs","useStore","recalculatePriceLock","ref","recalculateFatRate","String","recalculateBasePriceWithVat","init","basePrice","basePriceHidden","toFixed","offer","nextTick","then","recalculateBasePrice","basePriceWithVat","recalculatePayoffTariffLock","recalculatePayoffTariff","vat","isNaN","tariff","recalculatePayoffTariffWithTax","useSetFormula","setFormula","available_formula_by_subject","f","_","some","el","map","foundStandard","find","foundPhysicalWeight","useInitialParams","initialParams","properties","property","fieldsNames","processParams","fieldset","fieldsetObject","propertiesArray","excludedFields","k","val","field","cond","fix","after_dot","undefined","def","useUpdatePoints","isInit","requestData","storePoint","useStorePoint","updatePoints","parseInt","getAllPoints","points","getPoints","noStore","p","subject_to_buy","length","found","useInit","setWatchers","storePartner","useStorePartner","selectPartnerId","partners","updatePartner","updatePoint","updateSubject","updateFormula","updateStatus","useUpdate","initPartner","edit","partnerId","pointId","subjValue","initSelects","push","request","desc","foundPayoff","close","useWatch","callbacks","watchLock","watch","newValue","newHid","prevHid","lockWatchers","unlockWatchers","useFillForm","fillForm","sort","obj","baseFound","foundVat","useData","fetchData","useRequestForm","setFieldRef","validateForm","resetValidations","useFormValidate","isChanged","_hoisted_1","class","_hoisted_2","style","_defineComponent","__name","props","icon","type","disabled","Boolean","default","suffix","localePrettify","emits","setup","__props","expose","__expose","emit","toast","useToast","v$","useVuelidate","validationError","computed","$errors","set","validate","isValid","$validate","add","severity","summary","detail","$message","validationReset","$reset","onBlur","window","removeEventListener","onKeyDown","clear","onFocus","addEventListener","result","e","keyCode","onDown","onUp","split","parsed","div","i","readyNumber","_ctx","_cache","_component_InputText","_resolveComponent","_openBlock","_createBlock","LacLabel","_withCtx","_createElementVNode","_createVNode","modelValue","$event","_normalizeClass","_toDisplayString","__exports__"],"sourceRoot":""}