{"version":3,"file":"js/partnerCreate.5c2f23fa.js","mappings":"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","sources":["webpack://lac/./src/kernel/validation/vuelidate/innRules.ts","webpack://lac/./src/views/modules/CrudForms/LacPartnerForm/usePartnerForm.ts","webpack://lac/./src/views/modules/CrudForms/LacPartnerForm/LacCreatePartnerForm.vue?ee23","webpack://lac/./src/views/modules/CrudForms/LacPartnerForm/LacCreatePartnerForm.vue","webpack://lac/./src/views/pages/partner/PartnerCreatePage.vue?d2c0","webpack://lac/./src/views/pages/partner/PartnerCreatePage.vue"],"sourcesContent":["import {\r\n  helpers,\r\n  maxLength,\r\n  minLength,\r\n  numeric,\r\n  required,\r\n} from \"@vuelidate/validators\";\r\n\r\nexport const innRules = () => ({\r\n  required: helpers.withMessage(\"Это поле обязательно\", required),\r\n  numeric: helpers.withMessage(\"ИНН может состоять только из цифр\", numeric),\r\n  inn: helpers.withMessage(\r\n    \"Длина ИНН должна быть 10 или 12 символов\",\r\n    (value: string) => value.length === 10 || value.length === 12\r\n  ),\r\n});\r\n","import { computed, ComputedRef, reactive, resolveTransitionHooks } from \"vue\";\r\nimport { useStore } from \"@/store\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { ReactiveVariable } from \"vue/macros\";\r\nimport {\r\n  FormFieldProps,\r\n  FormFieldSelectProps,\r\n  LacSelectOption,\r\n} from \"@/views/components/form/types\";\r\nimport { PartnerAddData } from \"@/kernel/api/dto/Partner\";\r\nimport { useFormValidate } from \"@/use/useFormValidate\";\r\nimport { useStorePartner } from \"@/store/partner\";\r\nimport { PartnerType } from \"@/kernel/entities/Partner\";\r\nimport { PhoneForm } from \"@/kernel/entities/types\";\r\nimport { emailRules } from \"@/kernel/validation/vuelidate/emailRules\";\r\nimport { maxLengthRules } from \"@/kernel/validation/vuelidate/maxLengthRules\";\r\nimport { phoneObjRules } from \"@/kernel/validation/vuelidate/phoneObjRules\";\r\nimport { requiredRules } from \"@/kernel/validation/vuelidate/requiredRules\";\r\nimport { innRules } from \"@/kernel/validation/vuelidate/innRules\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\n\r\nexport const usePartnerForm = () => {\r\n  const router = useRouter();\r\n  const route = useRoute();\r\n  const partner_id = parseInt(route.params.id as string);\r\n  const { setFieldRef, validateForm, resetValidations } = useFormValidate();\r\n  const storePartner = useStorePartner();\r\n  const { partners } = storeToRefs(storePartner);\r\n\r\n  const { dictionary } = storeToRefs(useStore());\r\n\r\n  const partnerTypes: ComputedRef<PartnerType[]> = computed(() => {\r\n    const dictPartnerType = dictionary.value\r\n      ? dictionary.value.partner.type\r\n      : {};\r\n\r\n    return Object.keys(dictPartnerType).map((key) =>\r\n      storePartner.createPartnerType(key)\r\n    );\r\n  });\r\n\r\n  const partnerType: ReactiveVariable<FormFieldSelectProps<PartnerType>> =\r\n    reactive({\r\n      value: null,\r\n      id: \"type\",\r\n      label: \"Тип\",\r\n      items: partnerTypes,\r\n      rules: requiredRules(),\r\n    });\r\n\r\n  const partnerPhone: ReactiveVariable<PhoneForm[]> = reactive([]);\r\n\r\n  const fields: ReactiveVariable<Record<string, FormFieldProps>> = reactive({\r\n    inn: {\r\n      value: \"\",\r\n      id: \"inn\",\r\n      label: \"ИНН\",\r\n      rules: innRules(),\r\n    },\r\n    fullname: {\r\n      value: \"\",\r\n      id: \"fullname\",\r\n      label: \"Полное наименование\",\r\n      rules: requiredRules(),\r\n    },\r\n    name: {\r\n      value: \"\",\r\n      id: \"name\",\r\n      label: \"Краткое наименование\",\r\n      rules: requiredRules(),\r\n    },\r\n    website: {\r\n      value: \"\",\r\n      id: \"website\",\r\n      label: \"Сайт\",\r\n    },\r\n    email: {\r\n      value: \"\",\r\n      id: \"email\",\r\n      label: \"E-mail\",\r\n      rules: emailRules(),\r\n    },\r\n    comment: {\r\n      value: \"\",\r\n      id: \"comment\",\r\n      rules: maxLengthRules(),\r\n    },\r\n  });\r\n\r\n  function addPartnerPhone(phone?: PhoneForm[]) {\r\n    if (phone) {\r\n      for (const p of phone) {\r\n        partnerPhone.push({\r\n          phone: p.phone,\r\n          type: p.type,\r\n          extra: p.extra,\r\n          typeDisabled: true,\r\n        });\r\n      }\r\n    } else {\r\n      partnerPhone.push({\r\n        phone: \"\",\r\n        type: { value: \"work\", text: dictionary.value.phone.type[\"work\"] },\r\n        extra: \"\",\r\n        typeDisabled: true,\r\n      });\r\n    }\r\n  }\r\n\r\n  function removePartnerPhone(index: number) {\r\n    if (partnerPhone.length > 1) {\r\n      partnerPhone.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  function prepareData(): any {\r\n    const res: Record<string, any> = {};\r\n\r\n    Object.entries(fields).forEach(([key, value]) => {\r\n      if (value.value) {\r\n        res[key] = value.value;\r\n      }\r\n    });\r\n\r\n    res.phone = [];\r\n    for (const phone of partnerPhone) {\r\n      if (phone.phone && phone.type.value) {\r\n        res.phone.push(phone);\r\n      }\r\n    }\r\n\r\n    res.type = partnerType.value\r\n      ? (partnerType.value as LacSelectOption).value\r\n      : \"\";\r\n\r\n    return res as any;\r\n  }\r\n\r\n  function clear() {\r\n    Object.values(fields).forEach((el) => (el.value = \"\"));\r\n    partnerType.value = null;\r\n    resetValidations();\r\n  }\r\n\r\n  function successCallback(variant: string) {\r\n    clear();\r\n    router.back();\r\n  }\r\n\r\n  async function fillFromSelectedPartner() {\r\n    if (partners.value[partner_id] === undefined) {\r\n      await storePartner.fetch(partner_id);\r\n    }\r\n\r\n    partnerType.value =\r\n      partnerTypes.value.find(\r\n        (el) => el.value === partners.value[partner_id].type.value\r\n      ) || null;\r\n\r\n    addPartnerPhone(partners.value[partner_id].phone);\r\n\r\n    fields.fullname.value = partners.value[partner_id].fullname;\r\n    fields.inn.value = partners.value[partner_id].inn;\r\n    fields.name.value = partners.value[partner_id].name;\r\n    fields.website.value = partners.value[partner_id].website || \"\";\r\n    fields.email.value = partners.value[partner_id].email || \"\";\r\n    fields.comment.value = partners.value[partner_id].comment || \"\";\r\n  }\r\n\r\n  async function editPartner() {\r\n    await storePartner.edit(prepareData(), partner_id);\r\n  }\r\n\r\n  return {\r\n    partnerType,\r\n    partnerPhone,\r\n    fields,\r\n    successCallback,\r\n    prepareData,\r\n    setFieldRef,\r\n    validateForm,\r\n    editPartner,\r\n    fillFromSelectedPartner,\r\n    addPartnerPhone,\r\n    removePartnerPhone,\r\n  };\r\n};\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, withCtx as _withCtx, resolveComponent as _resolveComponent, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"onSubmit\"]\n\nimport LacFieldset from \"@/views/components/form/field/LacFieldset.vue\";\r\nimport LacInputText from \"@/views/components/form/input/LacInputText.vue\";\r\nimport LacTextarea from \"@/views/components/form/input/LacTextarea.vue\";\r\nimport LacSelect from \"@/views/components/form/select/LacSelect.vue\";\r\nimport LacPhone from \"@/views/components/form/input/LacPhone.vue\";\r\n\r\nimport { useStorePartner } from \"@/store/partner\";\r\nimport { useStoreModal } from \"@/store/modal\";\r\nimport { AvailableModalsEnum } from \"@/store/modal/types\";\r\nimport { usePartnerForm } from \"@/views/modules/CrudForms/LacPartnerForm/usePartnerForm\";\r\nimport { useFieldsetCols } from \"@/views/components/form/field/useFieldsetCols\";\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'LacCreatePartnerForm',\n  setup(__props) {\n\r\nconst { computedCols } = useFieldsetCols();\r\nconst {\r\n  fields,\r\n  partnerType,\r\n  partnerPhone,\r\n  setFieldRef,\r\n  successCallback,\r\n  validateForm,\r\n  prepareData,\r\n  addPartnerPhone,\r\n  removePartnerPhone,\r\n} = usePartnerForm();\r\n\r\naddPartnerPhone();\r\n\r\nconst partnerState = useStorePartner();\r\nconst modals = useStoreModal();\r\n\r\nasync function onSubmit(): Promise<void> {\r\n  const isValid = await validateForm();\r\n  if (isValid) {\r\n    try {\r\n      modals.open(AvailableModalsEnum.LOADER);\r\n      await partnerState.create(prepareData());\r\n      modals.open(AvailableModalsEnum.SUCCESS, { callback: successCallback });\r\n    } catch (e) {\r\n      modals.open(AvailableModalsEnum.ERROR, {\r\n        text: (e as ErrorEvent).message,\r\n      });\r\n    }\r\n  }\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_Button = _resolveComponent(\"Button\")!\n\n  return (_openBlock(), _createElementBlock(\"form\", {\n    class: \"lac-form lac-create-partner-form\",\n    onSubmit: _withModifiers(onSubmit, [\"prevent\"])\n  }, [\n    _createVNode(LacFieldset, {\n      title: \"Общие параметры\",\n      class: \"mb16 lac-fieldset-params\",\n      grid: _unref(computedCols)\n    }, {\n      default: _withCtx(() => [\n        _createVNode(LacInputText, {\n          variant: \"horizontal\",\n          value: _unref(fields).fullname.value,\n          \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(fields).fullname.value) = $event)),\n          id: _unref(fields).fullname.id,\n          label: _unref(fields).fullname.label,\n          rules: _unref(fields).fullname.rules,\n          placeholder: \"\",\n          ref: _unref(setFieldRef)\n        }, null, 8, [\"value\", \"id\", \"label\", \"rules\"]),\n        _createVNode(LacSelect, {\n          variant: \"horizontal\",\n          value: _unref(partnerType).value,\n          \"onUpdate:value\": _cache[1] || (_cache[1] = ($event: any) => ((_unref(partnerType).value) = $event)),\n          items: _unref(partnerType).items,\n          id: _unref(partnerType).id,\n          label: _unref(partnerType).label,\n          rules: _unref(partnerType).rules,\n          placeholder: \"\",\n          ref: _unref(setFieldRef)\n        }, null, 8, [\"value\", \"items\", \"id\", \"label\", \"rules\"]),\n        _createVNode(LacInputText, {\n          variant: \"horizontal\",\n          value: _unref(fields).name.value,\n          \"onUpdate:value\": _cache[2] || (_cache[2] = ($event: any) => ((_unref(fields).name.value) = $event)),\n          id: _unref(fields).name.id,\n          label: _unref(fields).name.label,\n          rules: _unref(fields).name.rules,\n          placeholder: \"\",\n          ref: _unref(setFieldRef)\n        }, null, 8, [\"value\", \"id\", \"label\", \"rules\"]),\n        _createVNode(LacInputText, {\n          variant: \"horizontal\",\n          value: _unref(fields).inn.value,\n          \"onUpdate:value\": _cache[3] || (_cache[3] = ($event: any) => ((_unref(fields).inn.value) = $event)),\n          id: _unref(fields).inn.id,\n          label: _unref(fields).inn.label,\n          rules: _unref(fields).inn.rules,\n          placeholder: \"\",\n          ref: _unref(setFieldRef)\n        }, null, 8, [\"value\", \"id\", \"label\", \"rules\"])\n      ]),\n      _: 1\n    }, 8, [\"grid\"]),\n    _createVNode(LacFieldset, {\n      title: \"Контакты\",\n      class: \"mb16 lac-fieldset-contacts\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(LacInputText, {\n          variant: \"horizontal\",\n          value: _unref(fields).website.value,\n          \"onUpdate:value\": _cache[4] || (_cache[4] = ($event: any) => ((_unref(fields).website.value) = $event)),\n          id: _unref(fields).website.id,\n          label: _unref(fields).website.label,\n          placeholder: \"\",\n          ref: _unref(setFieldRef),\n          class: \"lac-fieldset-contacts-website\"\n        }, null, 8, [\"value\", \"id\", \"label\"]),\n        _createVNode(LacInputText, {\n          variant: \"horizontal\",\n          value: _unref(fields).email.value,\n          \"onUpdate:value\": _cache[5] || (_cache[5] = ($event: any) => ((_unref(fields).email.value) = $event)),\n          id: _unref(fields).email.id,\n          label: _unref(fields).email.label,\n          rules: _unref(fields).email.rules,\n          placeholder: \"\",\n          class: \"lac-fieldset-contacts-email\",\n          ref: _unref(setFieldRef)\n        }, null, 8, [\"value\", \"id\", \"label\", \"rules\"]),\n        _createVNode(LacPhone, {\n          value: _unref(partnerPhone),\n          onAdd: _unref(addPartnerPhone),\n          onRemove: _unref(removePartnerPhone)\n        }, null, 8, [\"value\", \"onAdd\", \"onRemove\"])\n      ]),\n      _: 1\n    }),\n    _createVNode(LacFieldset, {\n      title: \"Комментарий\",\n      class: \"mb8\"\n    }, {\n      default: _withCtx(() => [\n        _createVNode(LacTextarea, {\n          \"no-resize\": \"\",\n          rows: 3,\n          value: _unref(fields).comment.value,\n          \"onUpdate:value\": _cache[6] || (_cache[6] = ($event: any) => ((_unref(fields).comment.value) = $event)),\n          id: _unref(fields).comment.id,\n          rules: _unref(fields).comment.rules,\n          placeholder: \"\",\n          ref: _unref(setFieldRef)\n        }, null, 8, [\"value\", \"id\", \"rules\"])\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_Button, {\n      type: \"submit\",\n      label: \"Добавить\"\n    })\n  ], 40, _hoisted_1))\n}\n}\n\n})","import script from \"./LacCreatePartnerForm.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LacCreatePartnerForm.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LacCreatePartnerForm.vue?vue&type=style&index=0&id=18b41e45&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport LacCreatePartnerForm from \"@/views/modules/CrudForms/LacPartnerForm/LacCreatePartnerForm.vue\";\r\nimport FormTemplate from \"@/views/templates/FormTemplate/FormTemplate.vue\";\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PartnerCreatePage',\n  setup(__props) {\n\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(FormTemplate, { title: \"Добавление контрагента\" }, {\n    default: _withCtx(() => [\n      _createVNode(LacCreatePartnerForm)\n    ]),\n    _: 1\n  }))\n}\n}\n\n})","import script from \"./PartnerCreatePage.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./PartnerCreatePage.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["innRules","required","helpers","withMessage","numeric","inn","value","length","usePartnerForm","router","useRouter","route","useRoute","partner_id","parseInt","params","id","setFieldRef","validateForm","resetValidations","useFormValidate","storePartner","useStorePartner","partners","storeToRefs","dictionary","useStore","partnerTypes","computed","dictPartnerType","partner","type","Object","keys","map","key","createPartnerType","partnerType","reactive","label","items","rules","requiredRules","partnerPhone","fields","fullname","name","website","email","emailRules","comment","maxLengthRules","addPartnerPhone","phone","p","push","extra","typeDisabled","text","removePartnerPhone","index","splice","prepareData","res","entries","forEach","clear","values","el","successCallback","variant","back","async","fillFromSelectedPartner","undefined","fetch","find","editPartner","edit","_hoisted_1","_defineComponent","__name","setup","__props","computedCols","useFieldsetCols","partnerState","modals","useStoreModal","onSubmit","isValid","open","AvailableModalsEnum","LOADER","create","SUCCESS","callback","e","ERROR","message","_ctx","_cache","_component_Button","_resolveComponent","_openBlock","_createElementBlock","class","_withModifiers","_createVNode","LacFieldset","title","grid","_unref","default","_withCtx","LacInputText","$event","placeholder","ref","LacSelect","_","LacPhone","onAdd","onRemove","LacTextarea","rows","__exports__","_createBlock","FormTemplate","LacCreatePartnerForm"],"sourceRoot":""}