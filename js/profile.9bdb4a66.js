"use strict";(self["webpackChunklac"]=self["webpackChunklac"]||[]).push([[845],{2662:function(e,a,l){l.r(a),l.d(a,{default:function(){return r}});var n=l(3396),t=l(5242);const u=(0,n._)("div",null,"PROFILE",-1);var i=(0,n.aZ)({__name:"ProfilePage",setup(e){return(e,a)=>((0,n.wg)(),(0,n.j4)(t.Z,null,{default:(0,n.w5)((()=>[u])),_:1}))}});const s=i;var r=s},63:function(e,a,l){l.r(a),l.d(a,{default:function(){return F}});var n=l(3396),t=l(2793),u=l(9242),i=l(4870),s=l(140),r=l(6144),o=l(7174),d=l(137),v=l(9286),c=l(3856),m=l(1411),p=l(1020),_=l(1839),f=l(1735),U=l(8484),b=l(6342),S=l(6945),k=l(258);const h=()=>{const{setFieldRef:e,validateForm:a,resetValidations:l}=(0,f.Z)(),n=(0,k.S)(),{me:t,roleOptions:u}=(0,p.Jk)(n),s=(0,i.qj)({value:null,id:"role",label:"Тип",items:u,rules:(0,S.v)()}),r=(0,i.qj)({name:{value:"",id:"name",label:"ФИО",rules:(0,S.v)()},phone:{value:"",id:"phone",label:"Телефон",rules:(0,U.D)()},dob:{value:"",id:"dob",label:"Дата рождения",rules:(0,S.v)()},email:{value:"",id:"email",label:"E-mail",rules:(0,b.D)()}});function o(){const e={};return Object.entries(r).forEach((([a,l])=>{l.value&&(e[a]=l.value)})),e.role=s.value?s.value.value:"",e.user_id=t.value.user_id,e}function d(){Object.values(r).forEach((e=>e.value="")),s.value=null,l()}function v(e){d(),"new"!==e&&_.Z.back()}function c(){t.value&&(s.value=u.value.find((e=>e.value===t.value.role.value))||null,r.name.value=t.value.name,r.phone.value=t.value.phone,r.email.value=t.value.email||"",r.dob.value=t.value.dob||"")}return{userRole:s,fields:r,successCallback:v,prepareData:o,setFieldRef:e,validateForm:a,fillFromStore:c}};var w=l(4436);const g=["onSubmit"];var W=(0,n.aZ)({__name:"LacProfileForm",setup(e){const{fieldVariant:a}=(0,w.U)(),{computedCols:l}=(0,m.b)(),{fields:t,userRole:f,setFieldRef:U,validateForm:b,prepareData:S,fillFromStore:W}=h(),y=(0,k.S)(),{me:Z}=(0,p.Jk)(y),R=(0,v.N)(),j=(0,n.Fl)((()=>"admin"!==Z.value?.role.value));async function F(){if(j.value)return;const e=await b();if(e)try{R.open(c.y.LOADER),await y.edit(S()),W(),R.open(c.y.SUCCESS,{callback:()=>_.Z.back()})}catch(a){R.open(c.y.ERROR,{text:a.message})}}return(0,n.bv)((()=>{console.log("Profile init"),W()})),(e,v)=>{const c=(0,n.up)("Button");return(0,n.wg)(),(0,n.iD)("form",{class:"lac-form",onSubmit:(0,u.iM)(F,["prevent"])},[(0,n.Wm)(s.Z,{title:"Общие параметры",class:"mb16",grid:(0,i.SU)(l)},{default:(0,n.w5)((()=>[(0,n.Wm)(r.Z,{variant:(0,i.SU)(a),value:(0,i.SU)(t).name.value,"onUpdate:value":v[0]||(v[0]=e=>(0,i.SU)(t).name.value=e),id:(0,i.SU)(t).name.id,label:(0,i.SU)(t).name.label,rules:(0,i.SU)(t).name.rules,placeholder:"Text",ref:(0,i.SU)(U),disabled:j.value},null,8,["variant","value","id","label","rules","disabled"]),(0,n.Wm)(d.Z,{variant:(0,i.SU)(a),value:(0,i.SU)(t).phone.value,"onUpdate:value":v[1]||(v[1]=e=>(0,i.SU)(t).phone.value=e),id:(0,i.SU)(t).phone.id,label:(0,i.SU)(t).phone.label,rules:(0,i.SU)(t).phone.rules,ref:(0,i.SU)(U),disabled:j.value,"auto-clear":!1,mask:"+9 (999) 999-99-99",placeholder:"+9 (999) 999-99-99"},null,8,["variant","value","id","label","rules","disabled"]),(0,n.Wm)(o.Z,{variant:(0,i.SU)(a),value:(0,i.SU)(f).value,"onUpdate:value":v[2]||(v[2]=e=>(0,i.SU)(f).value=e),items:(0,i.SU)(f).items,id:(0,i.SU)(f).id,label:(0,i.SU)(f).label,rules:(0,i.SU)(f).rules,placeholder:"Должность",ref:(0,i.SU)(U),disabled:j.value},null,8,["variant","value","items","id","label","rules","disabled"]),(0,n.Wm)(r.Z,{variant:"horizontal",value:(0,i.SU)(t).email.value,"onUpdate:value":v[3]||(v[3]=e=>(0,i.SU)(t).email.value=e),id:(0,i.SU)(t).email.id,label:(0,i.SU)(t).email.label,rules:(0,i.SU)(t).email.rules,placeholder:"Text",ref:(0,i.SU)(U),disabled:j.value},null,8,["value","id","label","rules","disabled"]),(0,n.Wm)(r.Z,{variant:"horizontal",value:(0,i.SU)(t).dob.value,"onUpdate:value":v[4]||(v[4]=e=>(0,i.SU)(t).dob.value=e),id:(0,i.SU)(t).dob.id,label:(0,i.SU)(t).dob.label,placeholder:"Text",ref:(0,i.SU)(U),type:"date",disabled:j.value},null,8,["value","id","label","disabled"])])),_:1},8,["grid"]),(0,i.SU)(Z)&&"admin"===(0,i.SU)(Z).role?.value?((0,n.wg)(),(0,n.j4)(c,{key:0,label:"Сохранить",type:"submit",disabled:j.value},null,8,["disabled"])):(0,n.kq)("",!0)],40,g)}}});const y=W;var Z=y,R=(0,n.aZ)({__name:"ProfilePage",setup(e){return(e,a)=>((0,n.wg)(),(0,n.j4)(t.Z,{title:"Профиль"},{default:(0,n.w5)((()=>[(0,n.Wm)(Z)])),_:1}))}});const j=R;var F=j},5242:function(e,a,l){l.d(a,{Z:function(){return g}});var n=l(3396),t=l(4870),u=l(1020),i=l(5845),s=l(258);const r={class:"lac-header"},o={style:{"margin-left":"auto",display:"flex"}},d=(0,n._)("span",{class:"pi pi-user"},null,-1),v=(0,n._)("span",{class:"pi pi-sign-out",style:{color:"var(--lac-color__red)"}},null,-1),c={components:{}};var m=Object.assign(c,{__name:"LacHeader",setup(e){const{isShowAside:a}=(0,u.Jk)((0,i.o)()),l=(0,s.S)(),{me:c}=(0,u.Jk)(l);function m(){a.value=!0}return(e,l)=>{const u=(0,n.up)("Button"),i=(0,n.up)("RouterLink");return(0,n.wg)(),(0,n.iD)("div",r,[(0,t.SU)(a)?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(u,{key:0,icon:"pi pi-align-justify",onClick:m,text:""})),(0,n.Wm)(i,{class:"lac-header__link",to:{name:"map"}},{default:(0,n.w5)((()=>[(0,n.Uk)("Карта")])),_:1}),(0,n.Wm)(i,{class:"lac-header__link",to:{name:"offers"}},{default:(0,n.w5)((()=>[(0,n.Uk)("Предложения")])),_:1}),(0,n.Wm)(i,{class:"lac-header__link",to:{name:"requests"}},{default:(0,n.w5)((()=>[(0,n.Uk)("Спрос")])),_:1}),(0,t.SU)(c)&&"admin"===(0,t.SU)(c).role?.value?((0,n.wg)(),(0,n.j4)(i,{key:1,class:"lac-header__link",to:{name:"chain"}},{default:(0,n.w5)((()=>[(0,n.Uk)("Сделки")])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(i,{class:"lac-header__link",to:{name:"events"}},{default:(0,n.w5)((()=>[(0,n.Uk)("События")])),_:1}),(0,t.SU)(c)&&"admin"===(0,t.SU)(c).role?.value?((0,n.wg)(),(0,n.iD)(n.HY,{key:2},[(0,n.Wm)(i,{class:"lac-header__link",to:{name:"adminUsers"}},{default:(0,n.w5)((()=>[(0,n.Uk)(" Пользователи ")])),_:1}),(0,n.Wm)(i,{class:"lac-header__link",to:{name:"adminRoles"}},{default:(0,n.w5)((()=>[(0,n.Uk)(" Должности ")])),_:1})],64)):(0,n.kq)("",!0),(0,n._)("div",o,[(0,n.Wm)(i,{class:"lac-header__link",to:{name:"profile"}},{default:(0,n.w5)((()=>[(0,n.Uk)(" Профиль "),d])),_:1}),(0,n.Wm)(i,{class:"lac-header__link lac-header__link--logout",to:{name:"logout"}},{default:(0,n.w5)((()=>[v])),_:1})])])}}});const p=m;var _=p;const f={class:"main-template"},U={class:"main-template__wrapper"},b={class:"main-template__right"},S={class:"main-template__header"},k={class:"main-template__main"};var h=(0,n.aZ)({__name:"MainTemplate",props:{overflowAuto:{type:Boolean,default:!1}},setup(e){return(e,a)=>((0,n.wg)(),(0,n.iD)("div",f,[(0,n._)("div",U,[(0,n.WI)(e.$slots,"aside",{class:"main-template__aside"}),(0,n._)("div",b,[(0,n._)("div",S,[(0,n.WI)(e.$slots,"header",{},(()=>[(0,n.Wm)(_)]))]),(0,n._)("main",k,[(0,n.WI)(e.$slots,"default")])])])]))}});const w=h;var g=w}}]);
//# sourceMappingURL=profile.9bdb4a66.js.map