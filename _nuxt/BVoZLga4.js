import{m as B,B as k,J as Q,K as U,L as N,o as h,c as b,a as c,M as j,N as z,O as Z,G as O,P as q,Q as A,F,b as L,R as P,S as f,r as _,T as ee,U as te,V as ae,W as se,X as R,Y as oe,Z as ne,t as V,d as w}from"./BgiJe7iG.js";import{useTokenClient as ie}from"./MkqiMGds.js";function le(s){const e={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};return s.size!==e.size||s.x!==e.x||s.y!==e.y||s.rotate!==e.rotate||s.flipX||s.flipY}const re={key:0,style:{display:"none"}},ue=["innerHTML"],ce=["innerHTML"],de=B({__name:"icon",props:{border:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},flip:{type:[Boolean,String],default:!1,validator:s=>[!0,!1,"horizontal","vertical","both"].includes(s)},icon:{type:[Object,Array,String],required:!0},mask:{type:[Object,Array,String],default:null},maskId:{type:String,default:void 0},listItem:{type:Boolean,default:!1},pull:{type:String,default:void 0,validator:s=>["right","left"].includes(s)},pulse:{type:Boolean,default:!1},rotation:{type:[String,Number],default:void 0,validator:s=>[90,180,270].includes(Number.parseInt(s,10))},swapOpacity:{type:Boolean,default:!1},size:{type:String,default:void 0,validator:s=>["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(s)},spin:{type:Boolean,default:!1},transform:{type:[String,Object],default:void 0},symbol:{type:[Boolean,String],default:!1},title:{type:String,default:void 0},titleId:{type:String,default:void 0},inverse:{type:Boolean,default:!1},bounce:{type:Boolean,default:!1},shake:{type:Boolean,default:!1},beat:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},beatFade:{type:Boolean,default:!1},spinPulse:{type:Boolean,default:!1},spinReverse:{type:Boolean,default:!1}},setup(s){const e=s,y=k(()=>S(e.icon)),o=k(()=>S(e.mask)),p=k(()=>{if(e.transform){const t=typeof e.transform!="object"?Q.transform(e.transform):e.transform;if(t&&le(t))return C(t)}}),n=k(()=>U(y.value,{classes:T.value,title:e.title,titleId:e.titleId})),l=k(()=>U(o.value)),v=k(()=>{var a,i,r,u,m,d;const t={"aria-hidden":!0,"data-prefix":(a=n.value)==null?void 0:a.prefix,"data-icon":(i=n.value)==null?void 0:i.iconName,class:T.value,focusable:!1,role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${(r=n.value)==null?void 0:r.icon[0]} ${(u=n.value)==null?void 0:u.icon[1]}`};return e.symbol&&(t.id=[(m=n.value)==null?void 0:m.prefix,"fa",(d=n.value)==null?void 0:d.iconName].join("-")),e.title&&(t["aria-labelledby"]=E.value),t}),g=k(()=>{const t=x();if(l.value){const a=e.maskId||l.value.iconName;return`<defs>
      <clipPath id="clip-${a}">
        <path fill="currentColor" d="${l.value.icon[4]}"></path>
      </clipPath>
      <mask id="mask-${a}" x="0" y="0" width="100%" height="100%" maskUnits="userSpaceOnUse" maskContentUnits="userSpaceOnUse">
        <rect x="0" y="0" width="100%" height="100%" fill="white"></rect>
        ${t}
      </mask>
    </defs>
    <rect fill="currentColor" clip-path="url(#clip-${a})" mask="url(#mask-${a})" x="0" y="0" width="100%" height="100%"></rect>`}return t}),T=k(()=>{const t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-li":e.listItem,"fa-inverse":e.inverse,"fa-flip":e.flip===!0,"fa-flip-horizontal":e.flip==="horizontal"||e.flip==="both","fa-flip-vertical":e.flip==="vertical"||e.flip==="both",[`fa-${e.size}`]:e.size!==void 0,[`fa-rotate-${e.rotation}`]:e.rotation!==void 0,[`fa-pull-${e.pull}`]:e.pull!==void 0,"fa-swap-opacity":e.swapOpacity,"fa-bounce":e.bounce,"fa-shake":e.shake,"fa-beat":e.beat,"fa-fade":e.fade,"fa-beat-fade":e.beatFade,"fa-spin-pulse":e.spinPulse,"fa-spin-reverse":e.spinReverse},a=Object.keys(t).map(i=>t[i]?i:null).filter(i=>i);return[N.replacementClass,...a]}),E=k(()=>N.replacementClass+"-title-"+(e.titleId||D()));function S(t){if(t){if(typeof t=="string"){const a={solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab"};let i=a[N.styleDefault]||"fas",r=t.replace(/\bfa-/g,"");if(r.includes(" ")){const u=r.split(/\s+/);u[0]in a&&(i=a[u[0]]),r=u[1]}return{prefix:i,iconName:r}}if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="object"&&"prefix"in t&&"iconName"in t)return t}}function C(t){var M;const i=((M=n.value)==null?void 0:M.icon[0])||512,r=t.x||0,u=t.y||0,m=t.size||0,d=t.rotate||0,I=t.flipX||0,$=t.flipY||0,Y="translate(".concat(String(512/2)," 256)"),G="translate(".concat(String(r*32),", ").concat(String(u*32),") "),H="scale(".concat(String(m/16*(I?-1:1)),", ").concat(String(m/16*($?-1:1)),") "),K="rotate(".concat(String(d)," 0 0)"),X="".concat(G," ").concat(H," ").concat(K),J="translate(".concat(String(i/2*-1)," -256)");return{outer:Y,inner:X,path:J}}function D(){const t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let a=12,i="";for(;a-- >0;)i+=t[Math.random()*62|0];return i}function x(){const t=l.value?"black":"currentColor",a=[];let i=n.value.icon[4];return Array.isArray(i)||(i=[i]),i.forEach(r=>{a.push(`<path fill="${t}"${p.value?' transform="'+p.value.path+'"':""} d="${r}"></path>`)}),p.value&&(a.unshift(`<g transform="${p.value.outer}">`,`<g transform="${p.value.inner}">`),a.push("</g>","</g>")),e.title&&a.unshift(`<title id="${E.value}">${e.title}</title>`),a.join("")}return e.icon&&!n.value&&console.info("Could not find main icon",y.value),e.mask&&!l.value&&console.info("Could not find mask icon",o.value),(t,a)=>n.value&&s.symbol?(h(),b("svg",re,[c("symbol",j(v.value,{innerHTML:g.value}),null,16,ue)])):n.value?(h(),b("svg",j({key:1},v.value,{innerHTML:g.value}),null,16,ce)):z("",!0)}}),W=Z("auth",{state:()=>({user:{email:"",code:void 0,remember:!1,accessToken:void 0,accessTokenExpiredDate:void 0,refreshToken:void 0,refreshTokenExpiredDate:void 0,googleToken:void 0},showVerification:!1,emailError:{value:!1,msg:""},codeError:{value:!1,msg:""}}),actions:{async googleLogin(){await $fetch(`${O().public.apiBase}/v1/auth/login/google`,{method:"POST",body:{accessToken:this.user.googleToken}}).then(s=>{this.user.accessTokenExpiredDate=s.data.accessToken,this.user.accessTokenExpiredDate=s.data.accessTokenExpiredDate,this.user.refreshToken=s.data.refreshToken,this.user.refreshTokenExpiredDate=s.data.refreshTokenExpiredDate,q(async e=>{A(e,"bearer-token",s.data.accessToken,{expires:s.data.accessTokenExpiredDate})}),F("/")}).catch(s=>{console.log(s),s.value=s})},async sendEmail(){const s=await $fetch(`${O().public.apiBase}/v1/auth/login/email`,{method:"POST",body:{email:this.user.email}});s.response.status==="success"?(this.emailError.value=!1,this.showVerification=!0):(this.emailError.msg=s.response.message,this.emailError.value=!0)},async sendCode(){const s=await $fetch(`${O().public.apiBase}/v1/auth/login/email/verify-code`,{method:"POST",body:{email:this.user.email,code:this.user.code,remember:this.user.remember}});s.response.status==="success"?(this.codeError.value=!1,this.user.accessTokenExpiredDate=s.data.accessToken,this.user.accessTokenExpiredDate=s.data.accessTokenExpiredDate,this.user.refreshToken=s.data.refreshToken,this.user.refreshTokenExpiredDate=s.data.refreshTokenExpiredDate,q(async e=>{A(e,"bearer-token",s.data.accessToken,{expires:s.data.accessTokenExpiredDate})}),F("/")):(this.codeError.msg=s.response.message,this.codeError.value=!0)}}}),fe=["disabled"],pe=B({__name:"GoogleBtn",setup(s){const e=W(),y=async l=>{e.user.googleToken=l.access_token,e.googleLogin()},o=l=>{console.log("Error: ",l)},{isReady:p,login:n}=ie({onSuccess:y,onError:o});return(l,v)=>{const g=de;return h(),b("button",{onClick:v[0]||(v[0]=P(()=>f(n)(),["prevent"])),disabled:!f(p),class:"btn btn_blue btn_google"},[L(g,{icon:["fab","google"]}),v[1]||(v[1]=c("span",null,"Sign up/Log in with Google",-1))],8,fe)}}}),ve={class:"ui-digit"},ge={class:"ui-digit-list"},me=["autoFocus","data-id","value","required","disabled","placeholder"],he=B({__name:"CodeInput",props:{fields:{type:Number,default:6},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!0}},emits:["change","complete"],setup(s,{emit:e}){const y=s,o=e,p={backspace:8,delete:46,left:37,up:38,right:39,down:40},n=_([]),l=_([]),v=_([]),g=ee(y,"fields"),T=_(0),E=()=>{let t;if(n.value&&n.value.length){t=[];for(let a=0;a<g.value;a++)t.push(n.value[a]||"");T.value=n.value.length>=g.value?0:n.value.length}else t=Array(g.value).fill("");l.value=[];for(let a=0;a<g.value;a++)l.value.push(a+1);n.value=t},S=t=>{t.target.select(t)},C=t=>{const a=parseInt(t.target.dataset.id);if(t.target.value=t.target.value.replace(/[^\d]/gi,""),t.target.value===""||!t.target.validity.valid)return;let i;const r=t.target.value;if(n.value=Object.assign([],n.value),r.length>1){let u=r.length+a-1;u>=g.value&&(u=g.value-1),i=l.value[u],r.split("").forEach((d,I)=>{const $=a+I;$<g.value&&(n.value[$]=d)})}else i=l.value[a+1],n.value[a]=r;if(i){const u=v.value[i];u.focus(),u.select()}x(n.value)},D=t=>{const a=parseInt(t.target.dataset.id),i=a-1,r=a+1,u=l.value[i],m=l.value[r];switch(t.keyCode){case p.backspace:{t.preventDefault();const d=[...n.value];n.value[a]?(d[a]="",n.value=d,x(d)):u&&(d[i]="",v.value[u].focus(),n.value=d,x(d));break}case p.delete:{t.preventDefault();const d=[...n.value];n.value[a]?(d[a]="",n.value=d,x(d)):m&&(d[r]="",v.value[m].focus(),n.value=d,x(d));break}case p.left:t.preventDefault(),u&&v.value[u].focus();break;case p.right:t.preventDefault(),m&&v.value[m].focus();break;case p.up:case p.down:t.preventDefault();break}},x=(t=n.value)=>{const a=t.join("");o("change",a),o("complete",a.length>=g.value)};return E(),te(()=>{v.value=[]}),(t,a)=>(h(),b("div",ve,[c("div",ge,[(h(!0),b(ae,null,se(f(n),(i,r)=>(h(),b("input",{key:r,class:"ui__digit",type:"number",pattern:"[0-9]",autoFocus:r===f(T),"data-id":r,value:i,ref_for:!0,ref:u=>{u&&(f(v)[r+1]=u)},onInput:C,onFocus:S,onKeydown:D,required:y.required,disabled:y.disabled,maxlength:"1",placeholder:String(r+1)},null,40,me))),128))])]))}}),be={class:"login-page"},ye={class:"checkbox login-page-checkbox"},ke={key:0,class:"login-verification-error"},xe={class:"login-verification-desc"},Te={class:"semibold"},Ee={key:0,class:"login-verification-error"},Se={class:"login-verification-resend"},we=B({__name:"login",setup(s){const e=W();return(y,o)=>{const p=pe,n=he;return h(),b("div",be,[f(e).showVerification?(h(),b("form",{key:1,onSubmit:o[5]||(o[5]=P(l=>f(e).sendCode(),["prevent"])),class:"login-verification-form"},[o[14]||(o[14]=c("div",{class:"login-title"},"Log in to Bettabite",-1)),c("div",xe,[o[12]||(o[12]=w("We have sent a six-digit code to ")),c("span",Te,V(f(e).user.email),1)]),L(n,{onChange:o[3]||(o[3]=l=>f(e).user.code=Number(l)),required:!0,class:"login-verification-code"}),f(e).codeError.value?(h(),b("div",Ee,V(f(e).codeError.msg),1)):z("",!0),o[15]||(o[15]=c("button",{class:"btn btn_blue login-verification-btn"},"Continue",-1)),c("div",Se,[o[13]||(o[13]=w("Didn’t receive an email? ")),c("span",{onClick:o[4]||(o[4]=l=>f(e).showVerification=!1),class:"login-verification-resend__link"},"Resend code")])],32)):(h(),b("form",{key:0,onSubmit:o[2]||(o[2]=P(l=>f(e).sendEmail(),["prevent"])),class:"login-form"},[o[8]||(o[8]=c("div",{class:"login-title"},"Sign up or Log in to Bettabite",-1)),L(p),o[9]||(o[9]=c("span",{class:"login-form__divider"},"or",-1)),c("div",null,[o[7]||(o[7]=c("label",{class:"input-label",for:"inputLoginEmail"},"Email",-1)),R(c("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>f(e).user.email=l),class:"input",id:"inputLoginEmail",placeholder:"name@email.com",type:"email",required:""},null,512),[[oe,f(e).user.email]]),c("label",ye,[R(c("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>f(e).user.remember=l),type:"checkbox"},null,512),[[ne,f(e).user.remember]]),o[6]||(o[6]=c("span",null,"Keep me signed in",-1))])]),o[10]||(o[10]=c("button",{class:"btn btn_transparent"},[c("span",null,"Continue with email")],-1)),f(e).emailError.value?(h(),b("div",ke,V(f(e).emailError.msg),1)):z("",!0),o[11]||(o[11]=c("div",{class:"login-form-desc"},[w("By creating an account you agree with our Terms of Service, Privacy Policy"),c("br"),w("and our default Notifications Settings.")],-1))],32))])}}});export{we as default};
